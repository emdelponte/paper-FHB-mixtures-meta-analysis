<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>code-yld.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">DMI+QoI premix effects on FHB</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa fa fa-home"></span>
     
    About
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fa fa fa fa-table"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa fa fa-file-code-o"></span>
     
    Documented analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="code-sev.html">FHB index</a>
    </li>
    <li>
      <a href="code-yld.html">Wheat yield</a>
    </li>
  </ul>
</li>
<li>
  <a href="plots.html">
    <span class="fa fa-bar-chart"></span>
     
    Publication-ready plots
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Code</h1>

</div>


<div id="cooperative-trials" class="section level1">
<h1>Cooperative Trials</h1>
<div id="network-model" class="section level2">
<h2>Network model</h2>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<pre class="r"><code>library(readr)
library(tidyverse)
fhb_yld1 &lt;- read_csv(&quot;data/dat-yld.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   trial = col_double(),
##   year = col_double(),
##   location = col_character(),
##   state = col_character(),
##   cultivar = col_character(),
##   reaction = col_character(),
##   n = col_double(),
##   AI = col_character(),
##   n_spray = col_double(),
##   yld_check = col_double(),
##   sev_check = col_double(),
##   mean_sev = col_double(),
##   publication = col_character(),
##   author = col_character(),
##   cons_group = col_double(),
##   AI2 = col_character(),
##   yld = col_double(),
##   V_yld = col_double(),
##   n2 = col_double()
## )</code></pre>
<pre class="r"><code>target &lt;- c(&quot;check-0&quot;, &quot;Azoxistrobina + Tebuconazole-2&quot;, &quot;Piraclostrobina + Metconazole-2&quot;, &quot;Tebuconazole-2&quot;, &quot;Trifloxistrobina + Protioconazole-2&quot;, &quot;Trifloxistrobina + Tebuconazole-2&quot;, &quot;Piraclostrobina + Metconazole-1&quot;) 
fhb_yld &lt;- fhb_yld1 %&gt;%
  group_by(trial) %&gt;% 
  filter(AI2 %in% target) %&gt;% 
  mutate(n2 = n()) %&gt;% 
  filter(n2 != 1)

# Renaming the treatments 
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;check-0&quot; = &quot;AACHECK&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Azoxistrobina + Tebuconazole-2&quot; = &quot;AZOX + TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Piraclostrobina + Metconazole-2&quot; = &quot;PIRA + METC 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Tebuconazole-2&quot; = &quot;TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Trifloxistrobina + Protioconazole-2&quot; = &quot;TFLX + PROT 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Trifloxistrobina + Tebuconazole-2&quot; = &quot;TFLX + TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Piraclostrobina + Metconazole-1&quot; = &quot;PIRA + METC 1X&quot;))
detach(&quot;package:plyr&quot;, unload = TRUE)


fhb_yld_coop = fhb_yld %&gt;% 
  filter(publication == &quot;Boletim&quot;)</code></pre>
</div>
<div id="sampling-variance" class="section level2">
<h2>Sampling Variance</h2>
<pre class="r"><code># Sampling variance for log of the mean (Paul et al., 2008) to use in multivariate model
fhb_yld_coop &lt;- fhb_yld_coop%&gt;%
  mutate(log_yld = log(yld))

fhb_yld_coop$log_var_yld &lt;- with(fhb_yld_coop, V_yld / (n * yld^2))

# Calculate the variation of absolute yield

fhb_yld_coop$var_yld &lt;- fhb_yld_coop$V_yld/fhb_yld_coop$n # multivariate approach</code></pre>
</div>
<div id="m-a-ai-yld-absolute" class="section level2">
<h2>M-A AI (yld Absolute)</h2>
<pre class="r"><code>library(metafor)

mv_yld &lt;- rma.mv(yld, var_yld,
  mods = ~AI2,
  random = list(~AI2 | trial),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_coop
)

summary(mv_yld)</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 175; method: ML)
## 
##     logLik    Deviance         AIC         BIC        AICc  
## -1230.1558    477.3586   2514.3115   2599.7607   2524.5972  
## 
## Variance Components: 
## 
## outer factor: trial (nlvls = 36)
## inner factor: AI2   (nlvls = 6)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1079454.4195  1038.9680     36     no         AACHECK
## tau^2.2    1361133.7514  1166.6764     23     no  AZOX + TEBU 2X
## tau^2.3    1397093.0755  1181.9869     35     no  PIRA + METC 2X
## tau^2.4    1329473.9721  1153.0282     11     no         TEBU 2X
## tau^2.5    1371668.3575  1171.1825     36     no  TFLX + PROT 2X
## tau^2.6    1402638.1578  1184.3303     34     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M2  rho.TEB2  rho.T+P2  rho.T+T2
## AACHECK                1    0.9764    0.9745    0.9713    0.9754    0.9804
## AZOX + TEBU 2X    0.9764         1    0.9964    0.9980    0.9922    0.9939
## PIRA + METC 2X    0.9745    0.9964         1    0.9958    0.9939    0.9988
## TEBU 2X           0.9713    0.9980    0.9958         1    0.9970    0.9944
## TFLX + PROT 2X    0.9754    0.9922    0.9939    0.9970         1    0.9961
## TFLX + TEBU 2X    0.9804    0.9939    0.9988    0.9944    0.9961         1
##                   AACH  A+T2  P+M2  TEB2  T+P2  T+T2
## AACHECK              -    no    no    no    no    no
## AZOX + TEBU 2X      23     -    no    no    no    no
## PIRA + METC 2X      35    23     -    no    no    no
## TEBU 2X             11    11    11     -    no    no
## TFLX + PROT 2X      36    23    35    11     -    no
## TFLX + TEBU 2X      34    23    34    11    34     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 169) = 68444.1022, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:6): 
## QM(df = 5) = 77.6177, p-val &lt; .0001
## 
## Model Results:
## 
##                     estimate        se     zval    pval      ci.lb
## intrcpt            2869.8979  174.9661  16.4026  &lt;.0001  2526.9707
## AI2AZOX + TEBU 2X   400.7449   56.6554   7.0734  &lt;.0001   289.7023
## AI2PIRA + METC 2X   468.2154   56.0053   8.3602  &lt;.0001   358.4471
## AI2TEBU 2X          386.6021   64.7320   5.9723  &lt;.0001   259.7297
## AI2TFLX + PROT 2X   449.2605   54.8084   8.1969  &lt;.0001   341.8381
## AI2TFLX + TEBU 2X   415.4660   51.5954   8.0524  &lt;.0001   314.3409
##                        ci.ub     
## intrcpt            3212.8251  ***
## AI2AZOX + TEBU 2X   511.7876  ***
## AI2PIRA + METC 2X   577.9837  ***
## AI2TEBU 2X          513.4744  ***
## AI2TFLX + PROT 2X   556.6829  ***
## AI2TFLX + TEBU 2X   516.5911  ***
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="contrasts" class="section level3">
<h3>Contrasts</h3>
<p>We can set linear contrasts between treatments of interest and get the P-valued using the <code>anova</code> function.</p>
<pre class="r"><code>anova(mv_yld, L = rbind(
  c(0, 1, -1, 0, 0, 0),
  c(0, 1, 0, -1, 0, 0),
  c(0, 1, 0, 0, -1, 0),
  c(0, 1, 0, 0, 0, -1),
  c(0, 0, 1, -1, 0, 0),
  c(0, 0, 1, 0, -1, 0),
  c(0, 0, 1, 0, 0, -1),
  c(0, 0, 0, 1, -1, 0),
  c(0, 0, 0, 1, 0, -1),
  c(0, 0, 0, 0, 1, -1)
))</code></pre>
<pre><code>## 
## Hypotheses:                                             
## 1:  AI2AZOX + TEBU 2X - AI2PIRA + METC 2X = 0
## 2:         AI2AZOX + TEBU 2X - AI2TEBU 2X = 0
## 3:  AI2AZOX + TEBU 2X - AI2TFLX + PROT 2X = 0
## 4:  AI2AZOX + TEBU 2X - AI2TFLX + TEBU 2X = 0
## 5:         AI2PIRA + METC 2X - AI2TEBU 2X = 0
## 6:  AI2PIRA + METC 2X - AI2TFLX + PROT 2X = 0
## 7:  AI2PIRA + METC 2X - AI2TFLX + TEBU 2X = 0
## 8:         AI2TEBU 2X - AI2TFLX + PROT 2X = 0
## 9:         AI2TEBU 2X - AI2TFLX + TEBU 2X = 0
## 10: AI2TFLX + PROT 2X - AI2TFLX + TEBU 2X = 0
## 
## Results:
##     estimate      se    zval   pval
## 1:  -67.4705 33.7616 -1.9984 0.0457
## 2:   14.1429 41.9391  0.3372 0.7359
## 3:  -48.5155 40.6732 -1.1928 0.2329
## 4:  -14.7211 39.4659 -0.3730 0.7091
## 5:   81.6134 44.4244  1.8371 0.0662
## 6:   18.9550 33.9363  0.5585 0.5765
## 7:   52.7494 22.2810  2.3675 0.0179
## 8:  -62.6584 43.2478 -1.4488 0.1474
## 9:  -28.8639 46.3773 -0.6224 0.5337
## 10:  33.7945 29.7806  1.1348 0.2565</code></pre>
</div>
</div>
<div id="m-a-ai-relative-yld" class="section level2">
<h2>M-A AI (Relative yld)</h2>
<pre class="r"><code>mv_yld_relative &lt;- rma.mv(log_yld, log_var_yld,
  mods = ~AI2,
  random = list(~AI2 | trial),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_coop
)

summary(mv_yld_relative)</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 175; method: ML)
## 
##    logLik   Deviance        AIC        BIC       AICc  
##  148.9586   498.6970  -243.9172  -158.4680  -233.6315  
## 
## Variance Components: 
## 
## outer factor: trial (nlvls = 36)
## inner factor: AI2   (nlvls = 6)
## 
##             estim    sqrt  k.lvl  fixed           level
## tau^2.1    0.4374  0.6614     36     no         AACHECK
## tau^2.2    0.4288  0.6548     23     no  AZOX + TEBU 2X
## tau^2.3    0.3870  0.6221     35     no  PIRA + METC 2X
## tau^2.4    0.4076  0.6384     11     no         TEBU 2X
## tau^2.5    0.3755  0.6127     36     no  TFLX + PROT 2X
## tau^2.6    0.4341  0.6589     34     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M2  rho.TEB2  rho.T+P2  rho.T+T2
## AACHECK                1    0.9932    0.9917    0.9918    0.9912    0.9935
## AZOX + TEBU 2X    0.9932         1    0.9982    0.9995    0.9969    0.9977
## PIRA + METC 2X    0.9917    0.9982         1    0.9983    0.9977    0.9997
## TEBU 2X           0.9918    0.9995    0.9983         1    0.9987    0.9981
## TFLX + PROT 2X    0.9912    0.9969    0.9977    0.9987         1    0.9984
## TFLX + TEBU 2X    0.9935    0.9977    0.9997    0.9981    0.9984         1
##                   AACH  A+T2  P+M2  TEB2  T+P2  T+T2
## AACHECK              -    no    no    no    no    no
## AZOX + TEBU 2X      23     -    no    no    no    no
## PIRA + METC 2X      35    23     -    no    no    no
## TEBU 2X             11    11    11     -    no    no
## TFLX + PROT 2X      36    23    35    11     -    no
## TFLX + TEBU 2X      34    23    34    11    34     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 169) = 17540.7691, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:6): 
## QM(df = 5) = 84.7544, p-val &lt; .0001
## 
## Model Results:
## 
##                    estimate      se     zval    pval   ci.lb   ci.ub     
## intrcpt              7.8371  0.1106  70.8430  &lt;.0001  7.6203  8.0539  ***
## AI2AZOX + TEBU 2X    0.1335  0.0179   7.4374  &lt;.0001  0.0983  0.1687  ***
## AI2PIRA + METC 2X    0.1617  0.0186   8.7059  &lt;.0001  0.1253  0.1981  ***
## AI2TEBU 2X           0.1317  0.0205   6.4371  &lt;.0001  0.0916  0.1718  ***
## AI2TFLX + PROT 2X    0.1582  0.0195   8.1263  &lt;.0001  0.1200  0.1963  ***
## AI2TFLX + TEBU 2X    0.1348  0.0163   8.2840  &lt;.0001  0.1029  0.1667  ***
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="contrasts-1" class="section level3">
<h3>Contrasts</h3>
<pre class="r"><code>anova(mv_yld_relative, L = rbind(
  c(0, 1, -1, 0, 0, 0),
  c(0, 1, 0, -1, 0, 0),
  c(0, 1, 0, 0, -1, 0),
  c(0, 1, 0, 0, 0, -1),
  c(0, 0, 1, -1, 0, 0),
  c(0, 0, 1, 0, -1, 0),
  c(0, 0, 1, 0, 0, -1),
  c(0, 0, 0, 1, -1, 0),
  c(0, 0, 0, 1, 0, -1),
  c(0, 0, 0, 0, 1, -1)
))</code></pre>
<pre><code>## 
## Hypotheses:                                             
## 1:  AI2AZOX + TEBU 2X - AI2PIRA + METC 2X = 0
## 2:         AI2AZOX + TEBU 2X - AI2TEBU 2X = 0
## 3:  AI2AZOX + TEBU 2X - AI2TFLX + PROT 2X = 0
## 4:  AI2AZOX + TEBU 2X - AI2TFLX + TEBU 2X = 0
## 5:         AI2PIRA + METC 2X - AI2TEBU 2X = 0
## 6:  AI2PIRA + METC 2X - AI2TFLX + PROT 2X = 0
## 7:  AI2PIRA + METC 2X - AI2TFLX + TEBU 2X = 0
## 8:         AI2TEBU 2X - AI2TFLX + PROT 2X = 0
## 9:         AI2TEBU 2X - AI2TFLX + TEBU 2X = 0
## 10: AI2TFLX + PROT 2X - AI2TFLX + TEBU 2X = 0
## 
## Results:
##     estimate     se    zval   pval
## 1:   -0.0282 0.0139 -2.0320 0.0422
## 2:    0.0018 0.0131  0.1395 0.8891
## 3:   -0.0247 0.0158 -1.5599 0.1188
## 4:   -0.0013 0.0136 -0.0984 0.9216
## 5:    0.0300 0.0146  2.0612 0.0393
## 6:    0.0035 0.0112  0.3137 0.7537
## 7:    0.0268 0.0103  2.6104 0.0090
## 8:   -0.0265 0.0144 -1.8360 0.0664
## 9:   -0.0032 0.0151 -0.2094 0.8341
## 10:   0.0233 0.0129  1.8044 0.0712</code></pre>
<pre class="r"><code>results_relative_yld&lt;- data.frame(cbind((exp(mv_yld_relative$b)-1)*100, 
                             (exp(mv_yld_relative$ci.lb)-1)*100,
                             (exp(mv_yld_relative$ci.ub)-1)*100))
results_relative_yld</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["X3"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"253191.32736","2":"2.038176e+05","3":"314519.67239","_rn_":"intrcpt"},{"1":"14.28098","2":"1.033064e+01","3":"18.37277","_rn_":"AI2AZOX + TEBU 2X"},{"1":"17.54782","2":"1.334624e+01","3":"21.90515","_rn_":"AI2PIRA + METC 2X"},{"1":"14.07242","2":"9.589824e+00","3":"18.73837","_rn_":"AI2TEBU 2X"},{"1":"17.13545","2":"1.275128e+01","3":"21.69009","_rn_":"AI2TFLX + PROT 2X"},{"1":"14.43406","2":"1.084123e+01","3":"18.14335","_rn_":"AI2TFLX + TEBU 2X"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="moderator-analysis" class="section level2">
<h2>Moderator analysis</h2>
<div id="cultivar" class="section level3">
<h3>Cultivar</h3>
<pre class="r"><code># creating two groups of cultivars (MR, S)
table(fhb_yld_coop$cultivar, fhb_yld_coop$reaction)</code></pre>
<pre><code>##                      
##                       MS MS/MR MS/S
##   BRS Grauna           0     0    5
##   BRS208              84     0    0
##   BRSGuabijú           5     0    0
##   Campeiro            14     0    0
##   Celebra              0     4    0
##   Fundacep Bravo       5     0    0
##   Fundacep46 Nova Era  6     0    0
##   Marfim               0     0    8
##   TBIO Itaipu          6     0    0
##   Tbio Sinuelo        10     0    0
##   TBIO Toruk          10     0    0
##   TEC 10               6     0    0</code></pre>
<pre class="r"><code>nrow(table(fhb_yld_coop$cultivar, fhb_yld_coop$reaction))</code></pre>
<pre><code>## [1] 12</code></pre>
<pre class="r"><code># Renaming the reactions 
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld_coop$reaction &lt;- revalue(fhb_yld_coop$reaction, c(&quot;MS&quot; = &quot;S&quot;))
fhb_yld_coop$reaction &lt;- revalue(fhb_yld_coop$reaction, c(&quot;MS/MR&quot; = &quot;MR&quot;))
fhb_yld_coop$reaction &lt;- revalue(fhb_yld_coop$reaction, c(&quot;MR/R&quot; = &quot;MR&quot;))</code></pre>
<pre><code>## The following `from` values were not present in `x`: MR/R</code></pre>
<pre class="r"><code>fhb_yld_coop$reaction &lt;- revalue(fhb_yld_coop$reaction, c(&quot;MS/S&quot; = &quot;S&quot;))
detach(&quot;package:plyr&quot;, unload = TRUE)</code></pre>
<pre><code>## Warning: &#39;plyr&#39; namespace cannot be unloaded:
##   namespace &#39;plyr&#39; is imported by &#39;ggplot2&#39; so cannot be unloaded</code></pre>
<pre class="r"><code>table(fhb_yld_coop$cultivar, fhb_yld_coop$reaction)</code></pre>
<pre><code>##                      
##                       MR  S
##   BRS Grauna           0  5
##   BRS208               0 84
##   BRSGuabijú           0  5
##   Campeiro             0 14
##   Celebra              4  0
##   Fundacep Bravo       0  5
##   Fundacep46 Nova Era  0  6
##   Marfim               0  8
##   TBIO Itaipu          0  6
##   Tbio Sinuelo         0 10
##   TBIO Toruk           0 10
##   TEC 10               0  6</code></pre>
<pre class="r"><code>table(fhb_yld_coop$reaction)</code></pre>
<pre><code>## 
##  MR   S 
##   4 159</code></pre>
<pre class="r"><code>table(fhb_yld_coop$AI2, fhb_yld_coop$reaction)</code></pre>
<pre><code>##                 
##                  MR  S
##   AACHECK         1 32
##   AZOX + TEBU 2X  0 23
##   PIRA + METC 2X  1 31
##   TEBU 2X         0 11
##   TFLX + PROT 2X  1 32
##   TFLX + TEBU 2X  1 30</code></pre>
<pre class="r"><code>mv_yld_reaction &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*reaction,
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_coop
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * reaction, random = list(~AI2
## | : Rows with NAs omitted from model fitting.</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * reaction, random = list(~AI2
## | : Redundant predictors dropped from the model.</code></pre>
<pre class="r"><code>mv_yld_reaction</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 163; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 33)
## inner factor: AI2           (nlvls = 6)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1056293.8231  1027.7616     33     no         AACHECK
## tau^2.2    1377485.5625  1173.6633     23     no  AZOX + TEBU 2X
## tau^2.3    1414570.4920  1189.3572     32     no  PIRA + METC 2X
## tau^2.4    1347725.1194  1160.9156     11     no         TEBU 2X
## tau^2.5    1407658.0847  1186.4477     33     no  TFLX + PROT 2X
## tau^2.6    1417053.7196  1190.4007     31     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M2  rho.TEB2  rho.T+P2  rho.T+T2
## AACHECK                1    0.9761    0.9732    0.9722    0.9787    0.9794
## AZOX + TEBU 2X    0.9761         1    0.9965    0.9981    0.9927    0.9934
## PIRA + METC 2X    0.9732    0.9965         1    0.9960    0.9943    0.9983
## TEBU 2X           0.9722    0.9981    0.9960         1    0.9969    0.9950
## TFLX + PROT 2X    0.9787    0.9927    0.9943    0.9969         1    0.9976
## TFLX + TEBU 2X    0.9794    0.9934    0.9983    0.9950    0.9976         1
##                   AACH  A+T2  P+M2  TEB2  T+P2  T+T2
## AACHECK              -    no    no    no    no    no
## AZOX + TEBU 2X      23     -    no    no    no    no
## PIRA + METC 2X      32    23     -    no    no    no
## TEBU 2X             11    11    11     -    no    no
## TFLX + PROT 2X      33    23    32    11     -    no
## TFLX + TEBU 2X      31    23    31    11    31     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 153) = 66532.7872, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:10): 
## QM(df = 9) = 66.5801, p-val &lt; .0001
## 
## Model Results:
## 
##                               estimate         se    zval    pval
## intrcpt                      2616.0000  1078.6713  2.4252  0.0153
## AI2AZOX + TEBU 2X             394.6236    60.4930  6.5235  &lt;.0001
## AI2PIRA + METC 2X             348.0000   553.2292  0.6290  0.5293
## AI2TEBU 2X                    381.9497    67.8598  5.6285  &lt;.0001
## AI2TFLX + PROT 2X             322.0000   539.9091  0.5964  0.5509
## AI2TFLX + TEBU 2X             279.0000   539.8056  0.5169  0.6053
## reactionS                     324.6690  1094.1921  0.2967  0.7667
## AI2PIRA + METC 2X:reactionS   112.4507   556.6788  0.2020  0.8399
## AI2TFLX + PROT 2X:reactionS   124.7485   542.9990  0.2297  0.8183
## AI2TFLX + TEBU 2X:reactionS   125.1378   542.8170  0.2305  0.8177
##                                   ci.lb      ci.ub     
## intrcpt                        501.8431  4730.1569    *
## AI2AZOX + TEBU 2X              276.0595   513.1876  ***
## AI2PIRA + METC 2X             -736.3092  1432.3092     
## AI2TEBU 2X                     248.9469   514.9524  ***
## AI2TFLX + PROT 2X             -736.2025  1380.2025     
## AI2TFLX + TEBU 2X             -778.9996  1336.9996     
## reactionS                    -1819.9082  2469.2462     
## AI2PIRA + METC 2X:reactionS   -978.6197  1203.5210     
## AI2TFLX + PROT 2X:reactionS   -939.5100  1189.0071     
## AI2TFLX + TEBU 2X:reactionS   -938.7640  1189.0396     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#anova(mv_yld_reaction, btt=9:14)</code></pre>
</div>
<div id="disease-pressure" class="section level3">
<h3>Disease Pressure</h3>
<pre class="r"><code>library(tidyverse)
fhb_yld_coop &lt;- fhb_yld_coop %&gt;%
  mutate(sev_check_class = case_when(
      sev_check &lt; 7 ~ &quot;low&quot;,
      sev_check &gt;= 7 ~ &quot;high&quot;))

mv_dis_press &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(sev_check_class),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_coop
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(sev_check_class),
## random = list(~AI2 | : Rows with NAs omitted from model fitting.</code></pre>
<pre class="r"><code>mv_dis_press</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 171; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 35)
## inner factor: AI2           (nlvls = 6)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1065427.4278  1032.1954     35     no         AACHECK
## tau^2.2    1359221.5950  1165.8566     23     no  AZOX + TEBU 2X
## tau^2.3    1402435.1788  1184.2446     34     no  PIRA + METC 2X
## tau^2.4    1290985.9681  1136.2156     11     no         TEBU 2X
## tau^2.5    1375857.7075  1172.9696     35     no  TFLX + PROT 2X
## tau^2.6    1410986.0853  1187.8494     33     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M2  rho.TEB2  rho.T+P2  rho.T+T2
## AACHECK                1    0.9821    0.9841    0.9734    0.9816    0.9878
## AZOX + TEBU 2X    0.9821         1    0.9970    0.9945    0.9920    0.9944
## PIRA + METC 2X    0.9841    0.9970         1    0.9966    0.9940    0.9991
## TEBU 2X           0.9734    0.9945    0.9966         1    0.9975    0.9960
## TFLX + PROT 2X    0.9816    0.9920    0.9940    0.9975         1    0.9961
## TFLX + TEBU 2X    0.9878    0.9944    0.9991    0.9960    0.9961         1
##                   AACH  A+T2  P+M2  TEB2  T+P2  T+T2
## AACHECK              -    no    no    no    no    no
## AZOX + TEBU 2X      23     -    no    no    no    no
## PIRA + METC 2X      34    23     -    no    no    no
## TEBU 2X             11    11    11     -    no    no
## TFLX + PROT 2X      35    23    34    11     -    no
## TFLX + TEBU 2X      33    23    33    11    33     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 159) = 61136.7594, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:12): 
## QM(df = 11) = 106.8917, p-val &lt; .0001
## 
## Model Results:
## 
##                                                estimate        se     zval
## intrcpt                                       2679.8184  239.3589  11.1958
## AI2AZOX + TEBU 2X                              399.5061   73.1429   5.4620
## AI2PIRA + METC 2X                              509.3401   66.6875   7.6377
## AI2TEBU 2X                                     358.3226   82.6746   4.3341
## AI2TFLX + PROT 2X                              474.1136   68.3412   6.9374
## AI2TFLX + TEBU 2X                              457.1826   62.3805   7.3289
## factor(sev_check_class)low                     438.7458  353.7798   1.2402
## AI2AZOX + TEBU 2X:factor(sev_check_class)low   -64.3035  108.1040  -0.5948
## AI2PIRA + METC 2X:factor(sev_check_class)low  -154.0271  102.1199  -1.5083
## AI2TEBU 2X:factor(sev_check_class)low           59.1295  127.0616   0.4654
## AI2TFLX + PROT 2X:factor(sev_check_class)low  -106.8933  104.5870  -1.0221
## AI2TFLX + TEBU 2X:factor(sev_check_class)low  -136.0425   95.8896  -1.4187
##                                                 pval      ci.lb      ci.ub
## intrcpt                                       &lt;.0001  2210.6835  3148.9533
## AI2AZOX + TEBU 2X                             &lt;.0001   256.1488   542.8635
## AI2PIRA + METC 2X                             &lt;.0001   378.6350   640.0453
## AI2TEBU 2X                                    &lt;.0001   196.2833   520.3619
## AI2TFLX + PROT 2X                             &lt;.0001   340.1673   608.0599
## AI2TFLX + TEBU 2X                             &lt;.0001   334.9191   579.4461
## factor(sev_check_class)low                    0.2149  -254.6499  1132.1415
## AI2AZOX + TEBU 2X:factor(sev_check_class)low  0.5520  -276.1835   147.5765
## AI2PIRA + METC 2X:factor(sev_check_class)low  0.1315  -354.1783    46.1241
## AI2TEBU 2X:factor(sev_check_class)low         0.6417  -189.9067   308.1658
## AI2TFLX + PROT 2X:factor(sev_check_class)low  0.3068  -311.8801    98.0934
## AI2TFLX + TEBU 2X:factor(sev_check_class)low  0.1560  -323.9825    51.8976
##                                                  
## intrcpt                                       ***
## AI2AZOX + TEBU 2X                             ***
## AI2PIRA + METC 2X                             ***
## AI2TEBU 2X                                    ***
## AI2TFLX + PROT 2X                             ***
## AI2TFLX + TEBU 2X                             ***
## factor(sev_check_class)low                       
## AI2AZOX + TEBU 2X:factor(sev_check_class)low     
## AI2PIRA + METC 2X:factor(sev_check_class)low     
## AI2TEBU 2X:factor(sev_check_class)low            
## AI2TFLX + PROT 2X:factor(sev_check_class)low     
## AI2TFLX + TEBU 2X:factor(sev_check_class)low     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_dis_press, btt=8:12)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 8:12): 
## QM(df = 5) = 8.5485, p-val = 0.1285</code></pre>
</div>
<div id="sev_check-as-continuous" class="section level3">
<h3>Sev_check as continuous</h3>
<pre class="r"><code>mv_sev_check_cont &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*as.numeric(sev_check),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_coop
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * as.numeric(sev_check), random
## = list(~AI2 | : Rows with NAs omitted from model fitting.</code></pre>
<pre class="r"><code>mv_sev_check_cont</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 171; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 35)
## inner factor: AI2           (nlvls = 6)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1     896716.0216   946.9509     35     no         AACHECK
## tau^2.2    1174318.2366  1083.6596     23     no  AZOX + TEBU 2X
## tau^2.3    1197272.6602  1094.1996     34     no  PIRA + METC 2X
## tau^2.4    1261547.9412  1123.1865     11     no         TEBU 2X
## tau^2.5    1230504.1033  1109.2809     35     no  TFLX + PROT 2X
## tau^2.6    1255042.4184  1120.2868     33     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M2  rho.TEB2  rho.T+P2  rho.T+T2
## AACHECK                1    0.9779    0.9773    0.9823    0.9800    0.9833
## AZOX + TEBU 2X    0.9779         1    0.9957    0.9996    0.9909    0.9934
## PIRA + METC 2X    0.9773    0.9957         1    0.9959    0.9937    0.9991
## TEBU 2X           0.9823    0.9996    0.9959         1    0.9935    0.9946
## TFLX + PROT 2X    0.9800    0.9909    0.9937    0.9935         1    0.9954
## TFLX + TEBU 2X    0.9833    0.9934    0.9991    0.9946    0.9954         1
##                   AACH  A+T2  P+M2  TEB2  T+P2  T+T2
## AACHECK              -    no    no    no    no    no
## AZOX + TEBU 2X      23     -    no    no    no    no
## PIRA + METC 2X      34    23     -    no    no    no
## TEBU 2X             11    11    11     -    no    no
## TFLX + PROT 2X      35    23    34    11     -    no
## TFLX + TEBU 2X      33    23    33    11    33     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 159) = 27530.6342, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:12): 
## QM(df = 11) = 97.5513, p-val &lt; .0001
## 
## Model Results:
## 
##                                           estimate        se     zval
## intrcpt                                  3184.5970  198.1674  16.0702
## AI2AZOX + TEBU 2X                         392.2417   66.2878   5.9173
## AI2PIRA + METC 2X                         450.2454   64.7408   6.9546
## AI2TEBU 2X                                345.2397   73.5899   4.6914
## AI2TFLX + PROT 2X                         406.5391   64.7601   6.2776
## AI2TFLX + TEBU 2X                         397.1288   62.8805   6.3156
## as.numeric(sev_check)                     -17.6911    6.5376  -2.7060
## AI2AZOX + TEBU 2X:as.numeric(sev_check)    -0.6679    2.0648  -0.3235
## AI2PIRA + METC 2X:as.numeric(sev_check)    -0.3634    2.0447  -0.1777
## AI2TEBU 2X:as.numeric(sev_check)            2.4930    2.7725   0.8992
## AI2TFLX + PROT 2X:as.numeric(sev_check)     1.2364    2.0457   0.6044
## AI2TFLX + TEBU 2X:as.numeric(sev_check)     0.2233    1.9645   0.1137
##                                            pval      ci.lb      ci.ub     
## intrcpt                                  &lt;.0001  2796.1959  3572.9980  ***
## AI2AZOX + TEBU 2X                        &lt;.0001   262.3201   522.1634  ***
## AI2PIRA + METC 2X                        &lt;.0001   323.3558   577.1350  ***
## AI2TEBU 2X                               &lt;.0001   201.0062   489.4732  ***
## AI2TFLX + PROT 2X                        &lt;.0001   279.6116   533.4666  ***
## AI2TFLX + TEBU 2X                        &lt;.0001   273.8853   520.3723  ***
## as.numeric(sev_check)                    0.0068   -30.5046    -4.8776   **
## AI2AZOX + TEBU 2X:as.numeric(sev_check)  0.7463    -4.7149     3.3790     
## AI2PIRA + METC 2X:as.numeric(sev_check)  0.8589    -4.3709     3.6441     
## AI2TEBU 2X:as.numeric(sev_check)         0.3686    -2.9411     7.9270     
## AI2TFLX + PROT 2X:as.numeric(sev_check)  0.5456    -2.7732     5.2460     
## AI2TFLX + TEBU 2X:as.numeric(sev_check)  0.9095    -3.6271     4.0738     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_sev_check_cont, btt=8:12)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 8:12): 
## QM(df = 5) = 3.6716, p-val = 0.5976</code></pre>
</div>
<div id="yield_class" class="section level3">
<h3>yield_class</h3>
<pre class="r"><code>#Moderator yield_class

summary(fhb_yld_coop$yld_check) # Median = 3002.03; Mean = 2896.47  </code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   67.33 2111.50 3002.03 2848.65 3591.00 4711.75</code></pre>
<pre class="r"><code>fhb_yld_coop &lt;- fhb_yld_coop %&gt;%
  mutate(yld_check_class = case_when(
      yld_check &lt; 3000 ~ &quot;low&quot;,
      yld_check &gt;= 3000 ~ &quot;high&quot;))
table(fhb_yld_coop$AI2, fhb_yld_coop$yld_check_class)</code></pre>
<pre><code>##                 
##                  high low
##   AACHECK          19  17
##   AZOX + TEBU 2X   12  11
##   PIRA + METC 2X   18  17
##   TEBU 2X           6   5
##   TFLX + PROT 2X   19  17
##   TFLX + TEBU 2X   17  17</code></pre>
<pre class="r"><code>mv_yld_check &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(yld_check_class),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_coop
)

mv_yld_check</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 175; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 36)
## inner factor: AI2           (nlvls = 6)
## 
##                  estim      sqrt  k.lvl  fixed           level
## tau^2.1    394038.7435  627.7251     36     no         AACHECK
## tau^2.2    586380.9802  765.7552     23     no  AZOX + TEBU 2X
## tau^2.3    596689.0458  772.4565     35     no  PIRA + METC 2X
## tau^2.4    584192.2019  764.3247     11     no         TEBU 2X
## tau^2.5    560336.9772  748.5566     36     no  TFLX + PROT 2X
## tau^2.6    558112.8842  747.0695     34     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M2  rho.TEB2  rho.T+P2  rho.T+T2
## AACHECK                1    0.9498    0.9430    0.9393    0.9391    0.9494
## AZOX + TEBU 2X    0.9498         1    0.9913    0.9954    0.9823    0.9883
## PIRA + METC 2X    0.9430    0.9913         1    0.9906    0.9867    0.9992
## TEBU 2X           0.9393    0.9954    0.9906         1    0.9945    0.9897
## TFLX + PROT 2X    0.9391    0.9823    0.9867    0.9945         1    0.9896
## TFLX + TEBU 2X    0.9494    0.9883    0.9992    0.9897    0.9896         1
##                   AACH  A+T2  P+M2  TEB2  T+P2  T+T2
## AACHECK              -    no    no    no    no    no
## AZOX + TEBU 2X      23     -    no    no    no    no
## PIRA + METC 2X      35    23     -    no    no    no
## TEBU 2X             11    11    11     -    no    no
## TFLX + PROT 2X      36    23    35    11     -    no
## TFLX + TEBU 2X      34    23    34    11    34     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 163) = 27660.8120, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:12): 
## QM(df = 11) = 160.4474, p-val &lt; .0001
## 
## Model Results:
## 
##                                                 estimate        se
## intrcpt                                        3652.7061  148.8202
## AI2AZOX + TEBU 2X                               446.5561   79.8593
## AI2PIRA + METC 2X                               516.9298   77.3592
## AI2TEBU 2X                                      418.1870   93.2869
## AI2TFLX + PROT 2X                               513.6841   75.8931
## AI2TFLX + TEBU 2X                               511.8201   72.1840
## factor(yld_check_class)low                    -1662.8365  214.8598
## AI2AZOX + TEBU 2X:factor(yld_check_class)low    -93.8221  110.6557
## AI2PIRA + METC 2X:factor(yld_check_class)low   -102.2254  108.5800
## AI2TEBU 2X:factor(yld_check_class)low           -71.6570  127.5321
## AI2TFLX + PROT 2X:factor(yld_check_class)low   -135.6211  106.9023
## AI2TFLX + TEBU 2X:factor(yld_check_class)low   -199.1284  100.1557
##                                                  zval    pval       ci.lb
## intrcpt                                       24.5444  &lt;.0001   3361.0239
## AI2AZOX + TEBU 2X                              5.5918  &lt;.0001    290.0347
## AI2PIRA + METC 2X                              6.6822  &lt;.0001    365.3085
## AI2TEBU 2X                                     4.4828  &lt;.0001    235.3480
## AI2TFLX + PROT 2X                              6.7685  &lt;.0001    364.9363
## AI2TFLX + TEBU 2X                              7.0905  &lt;.0001    370.3420
## factor(yld_check_class)low                    -7.7392  &lt;.0001  -2083.9540
## AI2AZOX + TEBU 2X:factor(yld_check_class)low  -0.8479  0.3965   -310.7032
## AI2PIRA + METC 2X:factor(yld_check_class)low  -0.9415  0.3465   -315.0383
## AI2TEBU 2X:factor(yld_check_class)low         -0.5619  0.5742   -321.6153
## AI2TFLX + PROT 2X:factor(yld_check_class)low  -1.2686  0.2046   -345.1457
## AI2TFLX + TEBU 2X:factor(yld_check_class)low  -1.9882  0.0468   -395.4299
##                                                    ci.ub     
## intrcpt                                        3944.3884  ***
## AI2AZOX + TEBU 2X                               603.0774  ***
## AI2PIRA + METC 2X                               668.5512  ***
## AI2TEBU 2X                                      601.0259  ***
## AI2TFLX + PROT 2X                               662.4319  ***
## AI2TFLX + TEBU 2X                               653.2982  ***
## factor(yld_check_class)low                    -1241.7190  ***
## AI2AZOX + TEBU 2X:factor(yld_check_class)low    123.0590     
## AI2PIRA + METC 2X:factor(yld_check_class)low    110.5874     
## AI2TEBU 2X:factor(yld_check_class)low           178.3013     
## AI2TFLX + PROT 2X:factor(yld_check_class)low     73.9036     
## AI2TFLX + TEBU 2X:factor(yld_check_class)low     -2.8269    *
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_yld_check, btt=8:12)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 8:12): 
## QM(df = 5) = 8.1717, p-val = 0.1470</code></pre>
</div>
<div id="state" class="section level3">
<h3>State</h3>
<pre class="r"><code># Number of entries by fungicide and state
table(fhb_yld_coop$AI2, fhb_yld_coop$state)</code></pre>
<pre><code>##                 
##                  PR RS SC
##   AACHECK        12 23  1
##   AZOX + TEBU 2X  8 14  1
##   PIRA + METC 2X 12 22  1
##   TEBU 2X         4  6  1
##   TFLX + PROT 2X 12 23  1
##   TFLX + TEBU 2X 12 21  1</code></pre>
<pre class="r"><code>mv_yld_state &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(state),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_coop
)

mv_yld_state</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 175; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 36)
## inner factor: AI2           (nlvls = 6)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1023603.8800  1011.7331     36     no         AACHECK
## tau^2.2    1332830.9883  1154.4830     23     no  AZOX + TEBU 2X
## tau^2.3    1353180.4441  1163.2628     35     no  PIRA + METC 2X
## tau^2.4    1093406.4962  1045.6608     11     no         TEBU 2X
## tau^2.5    1327330.2821  1152.0982     36     no  TFLX + PROT 2X
## tau^2.6    1375002.5214  1172.6050     34     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M2  rho.TEB2  rho.T+P2  rho.T+T2
## AACHECK                1    0.9768    0.9760    0.9662    0.9762    0.9817
## AZOX + TEBU 2X    0.9768         1    0.9959    0.9981    0.9912    0.9937
## PIRA + METC 2X    0.9760    0.9959         1    0.9936    0.9937    0.9991
## TEBU 2X           0.9662    0.9981    0.9936         1    0.9928    0.9906
## TFLX + PROT 2X    0.9762    0.9912    0.9937    0.9928         1    0.9953
## TFLX + TEBU 2X    0.9817    0.9937    0.9991    0.9906    0.9953         1
##                   AACH  A+T2  P+M2  TEB2  T+P2  T+T2
## AACHECK              -    no    no    no    no    no
## AZOX + TEBU 2X      23     -    no    no    no    no
## PIRA + METC 2X      35    23     -    no    no    no
## TEBU 2X             11    11    11     -    no    no
## TFLX + PROT 2X      36    23    35    11     -    no
## TFLX + TEBU 2X      34    23    34    11    34     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 157) = 52113.5519, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:18): 
## QM(df = 17) = 92.8754, p-val &lt; .0001
## 
## Model Results:
## 
##                                     estimate         se     zval    pval
## intrcpt                            2719.7982   294.5618   9.2334  &lt;.0001
## AI2AZOX + TEBU 2X                   392.0675    97.1425   4.0360  &lt;.0001
## AI2PIRA + METC 2X                   444.8113    94.3200   4.7160  &lt;.0001
## AI2TEBU 2X                          511.5090   111.5984   4.5835  &lt;.0001
## AI2TFLX + PROT 2X                   418.7054    93.2983   4.4878  &lt;.0001
## AI2TFLX + TEBU 2X                   427.8692    87.7082   4.8783  &lt;.0001
## factor(state)RS                     169.2437   363.8047   0.4652  0.6418
## factor(state)SC                    1470.2018  1062.7469   1.3834  0.1665
## AI2AZOX + TEBU 2X:factor(state)RS    33.7630   121.2615   0.2784  0.7807
## AI2PIRA + METC 2X:factor(state)RS    52.9028   116.9805   0.4522  0.6511
## AI2TEBU 2X:factor(state)RS         -186.0504   138.1703  -1.3465  0.1781
## AI2TFLX + PROT 2X:factor(state)RS    59.1423   115.4617   0.5122  0.6085
## AI2TFLX + TEBU 2X:factor(state)RS    -5.1995   109.2890  -0.0476  0.9621
## AI2AZOX + TEBU 2X:factor(state)SC  -297.0675   349.6257  -0.8497  0.3955
## AI2PIRA + METC 2X:factor(state)SC  -343.8113   355.6597  -0.9667  0.3337
## AI2TEBU 2X:factor(state)SC         -433.5090   351.0237  -1.2350  0.2168
## AI2TFLX + PROT 2X:factor(state)SC  -278.7054   349.2979  -0.7979  0.4249
## AI2TFLX + TEBU 2X:factor(state)SC  -318.8692   339.3712  -0.9396  0.3474
##                                         ci.lb      ci.ub     
## intrcpt                             2142.4677  3297.1286  ***
## AI2AZOX + TEBU 2X                    201.6717   582.4634  ***
## AI2PIRA + METC 2X                    259.9476   629.6751  ***
## AI2TEBU 2X                           292.7802   730.2378  ***
## AI2TFLX + PROT 2X                    235.8440   601.5667  ***
## AI2TFLX + TEBU 2X                    255.9642   599.7741  ***
## factor(state)RS                     -543.8004   882.2878     
## factor(state)SC                     -612.7438  3553.1475     
## AI2AZOX + TEBU 2X:factor(state)RS   -203.9052   271.4313     
## AI2PIRA + METC 2X:factor(state)RS   -176.3748   282.1804     
## AI2TEBU 2X:factor(state)RS          -456.8593    84.7584     
## AI2TFLX + PROT 2X:factor(state)RS   -167.1584   285.4430     
## AI2TFLX + TEBU 2X:factor(state)RS   -219.4020   209.0031     
## AI2AZOX + TEBU 2X:factor(state)SC   -982.3213   388.1862     
## AI2PIRA + METC 2X:factor(state)SC  -1040.8915   353.2688     
## AI2TEBU 2X:factor(state)SC         -1121.5027   254.4848     
## AI2TFLX + PROT 2X:factor(state)SC   -963.3167   405.9059     
## AI2TFLX + TEBU 2X:factor(state)SC   -984.0244   346.2861     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># anova(fhb_mv_AI_state,btt=8:15)
# 
# anova(fhb_mv_AI_state,btt=8:11)
# 
# anova(fhb_mv_AI_state,btt=11:15)</code></pre>
</div>
<div id="year-as-continuous" class="section level3">
<h3>Year as continuous</h3>
<pre class="r"><code># Number of entries by fungicide and year
table(fhb_yld_coop$AI2, fhb_yld_coop$year)</code></pre>
<pre><code>##                 
##                  2011 2012 2013 2014 2015 2017 2018
##   AACHECK           7    6    6    5    1    6    5
##   AZOX + TEBU 2X    7    5    6    5    0    0    0
##   PIRA + METC 2X    7    6    6    5    1    6    4
##   TEBU 2X           7    0    0    4    0    0    0
##   TFLX + PROT 2X    7    6    6    5    1    6    5
##   TFLX + TEBU 2X    7    5    6    5    1    6    4</code></pre>
<pre class="r"><code>mv_yld_year &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*as.numeric(year),
  random = list(~AI2 | factor(trial)),
  struct = &quot;HCS&quot;,
  method = &quot;ML&quot;,
  data = fhb_yld_coop
)

mv_yld_year</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 175; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 36)
## inner factor: AI2           (nlvls = 6)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1063510.3877  1031.2664     36     no         AACHECK
## tau^2.2    1341951.9234  1158.4265     23     no  AZOX + TEBU 2X
## tau^2.3    1354293.1181  1163.7410     35     no  PIRA + METC 2X
## tau^2.4    1454403.2110  1205.9864     11     no         TEBU 2X
## tau^2.5    1346490.3473  1160.3837     36     no  TFLX + PROT 2X
## tau^2.6    1418723.8335  1191.1019     34     no  TFLX + TEBU 2X
## rho              0.9919                       no                
## 
## Test for Residual Heterogeneity: 
## QE(df = 163) = 62400.6095, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:12): 
## QM(df = 11) = 150.1371, p-val &lt; .0001
## 
## Model Results:
## 
##                                         estimate           se     zval
## intrcpt                              113030.1989  139397.3870   0.8108
## AI2AZOX + TEBU 2X                     24175.6111   67343.3729   0.3590
## AI2PIRA + METC 2X                    -40040.1754   33818.9551  -1.1840
## AI2TEBU 2X                          -108996.5137   84810.8687  -1.2852
## AI2TFLX + PROT 2X                    -30600.5589   33491.3869  -0.9137
## AI2TFLX + TEBU 2X                    -31930.7039   36165.5125  -0.8829
## as.numeric(year)                        -54.6950      69.2150  -0.7902
## AI2AZOX + TEBU 2X:as.numeric(year)      -11.8295      33.4618  -0.3535
## AI2PIRA + METC 2X:as.numeric(year)       20.1078      16.7929   1.1974
## AI2TEBU 2X:as.numeric(year)              54.3711      42.1498   1.2899
## AI2TFLX + PROT 2X:as.numeric(year)       15.4122      16.6302   0.9268
## AI2TFLX + TEBU 2X:as.numeric(year)       16.0616      17.9578   0.8944
##                                       pval         ci.lb        ci.ub   
## intrcpt                             0.4175  -160183.6591  386244.0570   
## AI2AZOX + TEBU 2X                   0.7196  -107814.9745  156166.1967   
## AI2PIRA + METC 2X                   0.2364  -106324.1094   26243.7586   
## AI2TEBU 2X                          0.1987  -275222.7618   57229.7344   
## AI2TFLX + PROT 2X                   0.3609   -96242.4710   35041.3532   
## AI2TFLX + TEBU 2X                   0.3773  -102813.8058   38952.3980   
## as.numeric(year)                    0.4294     -190.3539      80.9639   
## AI2AZOX + TEBU 2X:as.numeric(year)  0.7237      -77.4135      53.7545   
## AI2PIRA + METC 2X:as.numeric(year)  0.2312      -12.8056      53.0212   
## AI2TEBU 2X:as.numeric(year)         0.1971      -28.2410     136.9831   
## AI2TFLX + PROT 2X:as.numeric(year)  0.3541      -17.1823      48.0067   
## AI2TFLX + TEBU 2X:as.numeric(year)  0.3711      -19.1350      51.2582   
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_yld_year, btt=8:12)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 8:12): 
## QM(df = 5) = 3.4155, p-val = 0.6362</code></pre>
</div>
</div>
</div>
<div id="publication" class="section level1">
<h1>Publication</h1>
<pre class="r"><code>fhb_yld_publ = fhb_yld %&gt;% 
  filter(publication != &quot;Boletim&quot;)</code></pre>
<div id="sampling-variance-1" class="section level2">
<h2>Sampling Variance</h2>
<pre class="r"><code># Sampling variance for log of the mean (Paul et al., 2008) to use in multivariate model
fhb_yld_publ &lt;- fhb_yld_publ%&gt;%
  mutate(log_yld = log(yld))

fhb_yld_publ$log_var_yld &lt;- with(fhb_yld_publ, V_yld / (n * yld^2))

# Calculate the variation of absolute yield

fhb_yld_publ$var_yld &lt;- fhb_yld_publ$V_yld/fhb_yld_publ$n # multivariate approach</code></pre>
</div>
<div id="m-a-ai-yld-absolute-1" class="section level2">
<h2>M-A AI (yld Absolute)</h2>
<pre class="r"><code>library(metafor)

mv_yld_publ &lt;- rma.mv(yld, var_yld,
  mods = ~AI2,
  random = list(~AI2 | trial),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>summary(mv_yld_publ)</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 110; method: ML)
## 
##    logLik   Deviance        AIC        BIC       AICc  
## -835.7814   330.6923  1731.5627  1812.5771  1755.1070  
## 
## Variance Components: 
## 
## outer factor: trial (nlvls = 33)
## inner factor: AI2   (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1349153.2423  1161.5306     33     no         AACHECK
## tau^2.2    1771003.0349  1330.7904      2     no  AZOX + TEBU 2X
## tau^2.3    1637595.2923  1279.6856     23     no  PIRA + METC 1X
## tau^2.4    1943010.0186  1393.9189     31     no  PIRA + METC 2X
## tau^2.5    1573702.5823  1254.4730     14     no         TEBU 2X
## tau^2.6    1682623.4388  1297.1598      5     no  TFLX + PROT 2X
## tau^2.7    1705980.4361  1306.1319      2     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9688    0.9748    0.9610    0.9540    0.9607
## AZOX + TEBU 2X    0.9688         1    0.0000    0.9992    0.0000    0.9992
## PIRA + METC 1X    0.9748    0.0000         1    0.9855    0.9966    0.9865
## PIRA + METC 2X    0.9610    0.9992    0.9855         1    0.9862    0.9999
## TEBU 2X           0.9540    0.0000    0.9966    0.9862         1    0.0000
## TFLX + PROT 2X    0.9607    0.9992    0.9865    0.9999    0.0000         1
## TFLX + TEBU 2X    0.9695    0.9996    0.0000    0.9995    0.0000    0.9993
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9695       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9996       2     -   yes    no   yes    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9995      31     2    23     -    no    no    no
## TEBU 2X           0.0000      14     0    11    12     -   yes   yes
## TFLX + PROT 2X    0.9993       5     2     2     5     0     -    no
## TFLX + TEBU 2X         1       2     2     0     2     0     2     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 103) = 8639.5303, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:7): 
## QM(df = 6) = 63.7171, p-val &lt; .0001
## 
## Model Results:
## 
##                     estimate        se     zval    pval      ci.lb
## intrcpt            3402.2163  206.4930  16.4762  &lt;.0001  2997.4974
## AI2AZOX + TEBU 2X   692.1572  204.6680   3.3819  0.0007   291.0153
## AI2PIRA + METC 1X   472.7760   70.6050   6.6961  &lt;.0001   334.3928
## AI2PIRA + METC 2X   626.7320   90.2597   6.9437  &lt;.0001   449.8263
## AI2TEBU 2X          546.6138   93.7275   5.8319  &lt;.0001   362.9113
## AI2TFLX + PROT 2X   340.3577  180.5924   1.8847  0.0595   -13.5970
## AI2TFLX + TEBU 2X   865.1621  201.4352   4.2950  &lt;.0001   470.3564
##                        ci.ub     
## intrcpt            3806.9352  ***
## AI2AZOX + TEBU 2X  1093.2991  ***
## AI2PIRA + METC 1X   611.1592  ***
## AI2PIRA + METC 2X   803.6378  ***
## AI2TEBU 2X          730.3163  ***
## AI2TFLX + PROT 2X   694.3123    .
## AI2TFLX + TEBU 2X  1259.9679  ***
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="contrasts-2" class="section level3">
<h3>Contrasts</h3>
<p>We can set linear contrasts between treatments of interest and get the P-valued using the <code>anova</code> function.</p>
<pre class="r"><code>anova(mv_yld_publ, L = rbind(
 c(0, 1, -1, 0, 0, 0, 0),
  c(0, 1, 0, -1, 0, 0, 0),
  c(0, 1, 0, 0, -1, 0, 0),
  c(0, 1, 0, 0, 0, -1, 0),
  c(0, 1, 0, 0, 0, 0, -1),
  c(0, 0, 1, -1, 0, 0, 0),
  c(0, 0, 1, 0, -1, 0, 0),
  c(0, 0, 1, 0, 0, -1, 0),
  c(0, 0, 1, 0, 0, 0, -1),
  c(0, 0, 0, 1, -1, 0, 0),
  c(0, 0, 0, 1, 0, -1, 0),
  c(0, 0, 0, 1, 0, 0, -1),
  c(0, 0, 0, 0, 1, -1, 0),
  c(0, 0, 0, 0, 1, 0, -1),
  c(0, 0, 0, 0, 0, 1, -1)
))</code></pre>
<pre><code>## 
## Hypotheses:                                             
## 1:  AI2AZOX + TEBU 2X - AI2PIRA + METC 1X = 0
## 2:  AI2AZOX + TEBU 2X - AI2PIRA + METC 2X = 0
## 3:         AI2AZOX + TEBU 2X - AI2TEBU 2X = 0
## 4:  AI2AZOX + TEBU 2X - AI2TFLX + PROT 2X = 0
## 5:  AI2AZOX + TEBU 2X - AI2TFLX + TEBU 2X = 0
## 6:  AI2PIRA + METC 1X - AI2PIRA + METC 2X = 0
## 7:         AI2PIRA + METC 1X - AI2TEBU 2X = 0
## 8:  AI2PIRA + METC 1X - AI2TFLX + PROT 2X = 0
## 9:  AI2PIRA + METC 1X - AI2TFLX + TEBU 2X = 0
## 10:        AI2PIRA + METC 2X - AI2TEBU 2X = 0
## 11: AI2PIRA + METC 2X - AI2TFLX + PROT 2X = 0
## 12: AI2PIRA + METC 2X - AI2TFLX + TEBU 2X = 0
## 13:        AI2TEBU 2X - AI2TFLX + PROT 2X = 0
## 14:        AI2TEBU 2X - AI2TFLX + TEBU 2X = 0
## 15: AI2TFLX + PROT 2X - AI2TFLX + TEBU 2X = 0
## 
## Results:
##      estimate       se    zval   pval
## 1:   219.3812 201.3475  1.0896 0.2759
## 2:    65.4252 196.6613  0.3327 0.7394
## 3:   145.5434 207.8979  0.7001 0.4839
## 4:   351.7996 209.9260  1.6758 0.0938
## 5:  -173.0049 219.9368 -0.7866 0.4315
## 6:  -153.9560  65.3413 -2.3562 0.0185
## 7:   -73.8378  65.5414 -1.1266 0.2599
## 8:   132.4183 176.3605  0.7508 0.4527
## 9:  -392.3861 198.6081 -1.9757 0.0482
## 10:   80.1182  80.5265  0.9949 0.3198
## 11:  286.3744 172.0496  1.6645 0.0960
## 12: -238.4301 194.4171 -1.2264 0.2201
## 13:  206.2561 183.4653  1.1242 0.2609
## 14: -318.5483 205.1404 -1.5528 0.1205
## 15: -524.8044 209.0140 -2.5109 0.0120</code></pre>
</div>
</div>
<div id="moderator-analysis-1" class="section level2">
<h2>Moderator analysis</h2>
<div id="cultivar-1" class="section level3">
<h3>Cultivar</h3>
<pre class="r"><code># creating two groups of cultivars (MR, S)
table(fhb_yld_publ$cultivar, fhb_yld_publ$reaction)</code></pre>
<pre><code>##                 
##                  MR MS MS/MR  S
##   Abalone         0  0     4  0
##   Ametista        0  8     0  0
##   BRS208          0  5     0  0
##   BRS23           0  4     0  0
##   BRSGuamirim     3  0     0  0
##   Campo Real      0  0     0  0
##   CD105           0  0     0  5
##   Fundacep Bravo  0  3     0  0
##   Linhagem 01/14  0  0     0  0
##   Mirante         0  0     0  8
##   Quartzo         0  4     0  0
##   Raízes          0  0     0  0
##   Supera          0  0     0  0
##   Taurum          0  0     0  8
##   TBIO Alvorada   8  0     0  0
##   Tbio Mestre     0  4     0  0
##   TBIO Pioneiro   0  0     0  0
##   Tbio Sinuelo    0  4     0  0
##   TBIO Toruk      0 16     0  0
##   TEC 02/13       0  0     0  0
##   TEC 10          0  3     0  0
##   Vigore          0  0     0  0</code></pre>
<pre class="r"><code>nrow(table(fhb_yld_publ$cultivar, fhb_yld_publ$reaction))</code></pre>
<pre><code>## [1] 22</code></pre>
<pre class="r"><code># Renaming the reactions 
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld_publ$reaction &lt;- revalue(fhb_yld_publ$reaction, c(&quot;MS&quot; = &quot;S&quot;))
fhb_yld_publ$reaction &lt;- revalue(fhb_yld_publ$reaction, c(&quot;MS/MR&quot; = &quot;MR&quot;))
fhb_yld_publ$reaction &lt;- revalue(fhb_yld_publ$reaction, c(&quot;MR/R&quot; = &quot;MR&quot;))</code></pre>
<pre><code>## The following `from` values were not present in `x`: MR/R</code></pre>
<pre class="r"><code>fhb_yld_publ$reaction &lt;- revalue(fhb_yld_publ$reaction, c(&quot;MS/S&quot; = &quot;S&quot;))</code></pre>
<pre><code>## The following `from` values were not present in `x`: MS/S</code></pre>
<pre class="r"><code>detach(&quot;package:plyr&quot;, unload = TRUE)</code></pre>
<pre><code>## Warning: &#39;plyr&#39; namespace cannot be unloaded:
##   namespace &#39;plyr&#39; is imported by &#39;ggplot2&#39; so cannot be unloaded</code></pre>
<pre class="r"><code>table(fhb_yld_publ$cultivar, fhb_yld_publ$reaction)</code></pre>
<pre><code>##                 
##                  MR  S
##   Abalone         4  0
##   Ametista        0  8
##   BRS208          0  5
##   BRS23           0  4
##   BRSGuamirim     3  0
##   Campo Real      0  0
##   CD105           0  5
##   Fundacep Bravo  0  3
##   Linhagem 01/14  0  0
##   Mirante         0  8
##   Quartzo         0  4
##   Raízes          0  0
##   Supera          0  0
##   Taurum          0  8
##   TBIO Alvorada   8  0
##   Tbio Mestre     0  4
##   TBIO Pioneiro   0  0
##   Tbio Sinuelo    0  4
##   TBIO Toruk      0 16
##   TEC 02/13       0  0
##   TEC 10          0  3
##   Vigore          0  0</code></pre>
<pre class="r"><code>table(fhb_yld_publ$reaction)</code></pre>
<pre><code>## 
## MR  S 
## 15 72</code></pre>
<pre class="r"><code>table(fhb_yld_publ$AI2, fhb_yld_publ$reaction)</code></pre>
<pre><code>##                 
##                  MR  S
##   AACHECK         4 21
##   AZOX + TEBU 2X  0  2
##   PIRA + METC 1X  4 12
##   PIRA + METC 2X  4 19
##   TEBU 2X         3 11
##   TFLX + PROT 2X  0  5
##   TFLX + TEBU 2X  0  2</code></pre>
<pre class="r"><code>mv_yld_reaction &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*reaction,
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * reaction, random = list(~AI2
## | : Rows with NAs omitted from model fitting.</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * reaction, random = list(~AI2
## | : Redundant predictors dropped from the model.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_reaction</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 87; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 25)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1518471.1447  1232.2626     25     no         AACHECK
## tau^2.2    2057493.5484  1434.3966      2     no  AZOX + TEBU 2X
## tau^2.3    1923932.6554  1387.0590     16     no  PIRA + METC 1X
## tau^2.4    2061516.2512  1435.7981     23     no  PIRA + METC 2X
## tau^2.5    1796712.1148  1340.4149     14     no         TEBU 2X
## tau^2.6    1785753.9221  1336.3210      5     no  TFLX + PROT 2X
## tau^2.7    1965221.9594  1401.8637      2     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9759    0.9751    0.9644    0.9591    0.9643
## AZOX + TEBU 2X    0.9759         1    0.0000    0.9989    0.0000    0.9988
## PIRA + METC 1X    0.9751    0.0000         1    0.9931    0.9980    0.9940
## PIRA + METC 2X    0.9644    0.9989    0.9931         1    0.9921    1.0000
## TEBU 2X           0.9591    0.0000    0.9980    0.9921         1    0.0000
## TFLX + PROT 2X    0.9643    0.9988    0.9940    1.0000    0.0000         1
## TFLX + TEBU 2X    0.9759    1.0000    0.0000    0.9988    0.0000    0.9988
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9759       -    no    no    no    no    no    no
## AZOX + TEBU 2X    1.0000       2     -   yes    no   yes    no    no
## PIRA + METC 1X    0.0000      16     0     -    no    no    no   yes
## PIRA + METC 2X    0.9988      23     2    16     -    no    no    no
## TEBU 2X           0.0000      14     0    11    12     -   yes   yes
## TFLX + PROT 2X    0.9988       5     2     2     5     0     -    no
## TFLX + TEBU 2X         1       2     2     0     2     0     2     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 76) = 5221.5450, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:11): 
## QM(df = 10) = 66.6135, p-val &lt; .0001
## 
## Model Results:
## 
##                               estimate        se     zval    pval
## intrcpt                      3522.3660  622.8555   5.6552  &lt;.0001
## AI2AZOX + TEBU 2X             807.5522  211.2729   3.8223  0.0001
## AI2PIRA + METC 1X             554.9667  207.1350   2.6793  0.0074
## AI2PIRA + METC 2X             816.0479  241.2362   3.3828  0.0007
## AI2TEBU 2X                    601.8193  238.4485   2.5239  0.0116
## AI2TFLX + PROT 2X             449.4681  187.2451   2.4004  0.0164
## AI2TFLX + TEBU 2X             974.9888  208.3121   4.6804  &lt;.0001
## reactionS                      28.9227  681.2248   0.0425  0.9661
## AI2PIRA + METC 1X:reactionS    12.1670  230.3990   0.0528  0.9579
## AI2PIRA + METC 2X:reactionS   -24.5514  267.8623  -0.0917  0.9270
## AI2TEBU 2X:reactionS           51.5654  265.9269   0.1939  0.8462
##                                   ci.lb      ci.ub     
## intrcpt                       2301.5915  4743.1404  ***
## AI2AZOX + TEBU 2X              393.4650  1221.6395  ***
## AI2PIRA + METC 1X              148.9896   960.9437   **
## AI2PIRA + METC 2X              343.2336  1288.8621  ***
## AI2TEBU 2X                     134.4689  1069.1697    *
## AI2TFLX + PROT 2X               82.4744   816.4619    *
## AI2TFLX + TEBU 2X              566.7046  1383.2731  ***
## reactionS                    -1306.2533  1364.0987     
## AI2PIRA + METC 1X:reactionS   -439.4067   463.7407     
## AI2PIRA + METC 2X:reactionS   -549.5518   500.4490     
## AI2TEBU 2X:reactionS          -469.6417   572.7726     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#anova(mv_yld_reaction, btt=9:14)</code></pre>
</div>
<div id="disease-pressure-1" class="section level3">
<h3>Disease Pressure</h3>
<pre class="r"><code>library(tidyverse)
fhb_yld_publ &lt;- fhb_yld_publ %&gt;%
  mutate(sev_check_class = case_when(
      sev_check &lt; 7 ~ &quot;low&quot;,
      sev_check &gt;= 7 ~ &quot;high&quot;))

mv_dis_press &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(sev_check_class),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(sev_check_class),
## random = list(~AI2 | : Rows with NAs omitted from model fitting.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_dis_press</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 66; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 22)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1272796.1927  1128.1827     22     no         AACHECK
## tau^2.2          0.7717     0.8784      2     no  AZOX + TEBU 2X
## tau^2.3    1069540.3037  1034.1858     12     no  PIRA + METC 1X
## tau^2.4    1251102.3565  1118.5269     20     no  PIRA + METC 2X
## tau^2.5    2645400.3239  1626.4687      3     no         TEBU 2X
## tau^2.6    1010730.6827  1005.3510      5     no  TFLX + PROT 2X
## tau^2.7          0.1066     0.3265      2     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    1.0000    0.9942    0.9926    1.0000    0.9994
## AZOX + TEBU 2X    1.0000         1    0.0000    0.9926    0.0000    0.9994
## PIRA + METC 1X    0.9942    0.0000         1    0.9738    0.0000    0.9898
## PIRA + METC 2X    0.9926    0.9926    0.9738         1    0.9927    0.9963
## TEBU 2X           1.0000    0.0000    0.0000    0.9927         1    0.0000
## TFLX + PROT 2X    0.9994    0.9994    0.9898    0.9963    0.0000         1
## TFLX + TEBU 2X    0.9966    0.9966    0.0000    0.9987    0.0000    0.9988
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9966       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9966       2     -   yes    no   yes    no    no
## PIRA + METC 1X    0.0000      12     0     -    no   yes    no   yes
## PIRA + METC 2X    0.9987      20     2    12     -    no    no    no
## TEBU 2X           0.0000       3     0     0     1     -   yes   yes
## TFLX + PROT 2X    0.9988       5     2     2     5     0     -    no
## TFLX + TEBU 2X         1       2     2     0     2     0     2     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 52) = 4890.0324, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:14): 
## QM(df = 13) = 243.1773, p-val &lt; .0001
## 
## Model Results:
## 
##                                                 estimate         se
## intrcpt                                        2807.1696   350.0941
## AI2AZOX + TEBU 2X                              1803.9802   413.6146
## AI2PIRA + METC 1X                               370.2412   152.3169
## AI2PIRA + METC 2X                               366.4067   133.5495
## AI2TEBU 2X                                      890.8547   196.8065
## AI2TFLX + PROT 2X                               452.5186   210.0431
## AI2TFLX + TEBU 2X                              1966.0019   413.7528
## factor(sev_check_class)low                      739.4318   495.1242
## AI2AZOX + TEBU 2X:factor(sev_check_class)low  -1889.5715   583.2923
## AI2PIRA + METC 1X:factor(sev_check_class)low   -198.5596   163.9605
## AI2PIRA + METC 2X:factor(sev_check_class)low    -46.0562   146.6786
## AI2TEBU 2X:factor(sev_check_class)low          -853.4453  1111.7575
## AI2TFLX + PROT 2X:factor(sev_check_class)low   -610.0459   335.4107
## AI2TFLX + TEBU 2X:factor(sev_check_class)low  -1863.4845   583.4906
##                                                  zval    pval       ci.lb
## intrcpt                                        8.0183  &lt;.0001   2120.9979
## AI2AZOX + TEBU 2X                              4.3615  &lt;.0001    993.3106
## AI2PIRA + METC 1X                              2.4307  0.0151     71.7057
## AI2PIRA + METC 2X                              2.7436  0.0061    104.6545
## AI2TEBU 2X                                     4.5266  &lt;.0001    505.1209
## AI2TFLX + PROT 2X                              2.1544  0.0312     40.8417
## AI2TFLX + TEBU 2X                              4.7516  &lt;.0001   1155.0613
## factor(sev_check_class)low                     1.4934  0.1353   -230.9938
## AI2AZOX + TEBU 2X:factor(sev_check_class)low  -3.2395  0.0012  -3032.8034
## AI2PIRA + METC 1X:factor(sev_check_class)low  -1.2110  0.2259   -519.9163
## AI2PIRA + METC 2X:factor(sev_check_class)low  -0.3140  0.7535   -333.5410
## AI2TEBU 2X:factor(sev_check_class)low         -0.7677  0.4427  -3032.4500
## AI2TFLX + PROT 2X:factor(sev_check_class)low  -1.8188  0.0689  -1267.4389
## AI2TFLX + TEBU 2X:factor(sev_check_class)low  -3.1937  0.0014  -3007.1051
##                                                   ci.ub     
## intrcpt                                       3493.3414  ***
## AI2AZOX + TEBU 2X                             2614.6499  ***
## AI2PIRA + METC 1X                              668.7768    *
## AI2PIRA + METC 2X                              628.1590   **
## AI2TEBU 2X                                    1276.5884  ***
## AI2TFLX + PROT 2X                              864.1954    *
## AI2TFLX + TEBU 2X                             2776.9426  ***
## factor(sev_check_class)low                    1709.8574     
## AI2AZOX + TEBU 2X:factor(sev_check_class)low  -746.3396   **
## AI2PIRA + METC 1X:factor(sev_check_class)low   122.7971     
## AI2PIRA + METC 2X:factor(sev_check_class)low   241.4286     
## AI2TEBU 2X:factor(sev_check_class)low         1325.5595     
## AI2TFLX + PROT 2X:factor(sev_check_class)low    47.3471    .
## AI2TFLX + TEBU 2X:factor(sev_check_class)low  -719.8639   **
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_dis_press, btt=9:14)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 9:14): 
## QM(df = 6) = 14.9417, p-val = 0.0207</code></pre>
</div>
<div id="sev_check-as-continuous-1" class="section level3">
<h3>Sev_check as continuous</h3>
<pre class="r"><code>mv_sev_check_cont &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*as.numeric(sev_check),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * as.numeric(sev_check), random
## = list(~AI2 | : Rows with NAs omitted from model fitting.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_sev_check_cont</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 66; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 22)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1353512.4447  1163.4055     22     no         AACHECK
## tau^2.2          0.0426     0.2065      2     no  AZOX + TEBU 2X
## tau^2.3    1118994.5671  1057.8254     12     no  PIRA + METC 1X
## tau^2.4    1350519.8197  1162.1187     20     no  PIRA + METC 2X
## tau^2.5     195498.9053   442.1526      3     no         TEBU 2X
## tau^2.6    1235879.8501  1111.7013      5     no  TFLX + PROT 2X
## tau^2.7          0.0226     0.1504      2     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1   -0.9992    0.9930    0.9941   -1.0000    0.9973
## AZOX + TEBU 2X   -0.9992         1    0.0000   -0.9901    0.0000   -0.9943
## PIRA + METC 1X    0.9930    0.0000         1    0.9744    0.0000    0.9815
## PIRA + METC 2X    0.9941   -0.9901    0.9744         1   -0.9944    0.9994
## TEBU 2X          -1.0000    0.0000    0.0000   -0.9944         1    0.0000
## TFLX + PROT 2X    0.9973   -0.9943    0.9815    0.9994    0.0000         1
## TFLX + TEBU 2X   -0.6604    0.6391    0.0000   -0.7222    0.0000   -0.7035
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK          -0.6604       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.6391       2     -   yes    no   yes    no    no
## PIRA + METC 1X    0.0000      12     0     -    no   yes    no   yes
## PIRA + METC 2X   -0.7222      20     2    12     -    no    no    no
## TEBU 2X           0.0000       3     0     0     1     -   yes   yes
## TFLX + PROT 2X   -0.7035       5     2     2     5     0     -    no
## TFLX + TEBU 2X         1       2     2     0     2     0     2     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 52) = 4546.8648, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:14): 
## QM(df = 13) = 197.0432, p-val &lt; .0001
## 
## Model Results:
## 
##                                           estimate        se     zval
## intrcpt                                  3378.5672  321.2584  10.5167
## AI2AZOX + TEBU 2X                         -53.6944  402.9321  -0.1333
## AI2PIRA + METC 1X                         218.3963   67.8591   3.2184
## AI2PIRA + METC 2X                         259.1704   57.8090   4.4832
## AI2TEBU 2X                               5877.9151  934.1668   6.2921
## AI2TFLX + PROT 2X                          -0.3859  249.1623  -0.0015
## AI2TFLX + TEBU 2X                         137.7795  402.9098   0.3420
## as.numeric(sev_check)                     -10.7955   10.0404  -1.0752
## AI2AZOX + TEBU 2X:as.numeric(sev_check)    31.5586   11.4837   2.7481
## AI2PIRA + METC 1X:as.numeric(sev_check)     0.4482    5.5325   0.0810
## AI2PIRA + METC 2X:as.numeric(sev_check)     7.5569    3.4440   2.1942
## AI2TEBU 2X:as.numeric(sev_check)         -133.5516   25.9977  -5.1371
## AI2TFLX + PROT 2X:as.numeric(sev_check)     8.0623    5.7360   1.4056
## AI2TFLX + TEBU 2X:as.numeric(sev_check)    31.0737   11.4829   2.7061
##                                            pval      ci.lb      ci.ub     
## intrcpt                                  &lt;.0001  2748.9124  4008.2221  ***
## AI2AZOX + TEBU 2X                        0.8940  -843.4268   736.0380     
## AI2PIRA + METC 1X                        0.0013    85.3948   351.3977   **
## AI2PIRA + METC 2X                        &lt;.0001   145.8670   372.4739  ***
## AI2TEBU 2X                               &lt;.0001  4046.9817  7708.8484  ***
## AI2TFLX + PROT 2X                        0.9988  -488.7350   487.9631     
## AI2TFLX + TEBU 2X                        0.7324  -651.9092   927.4682     
## as.numeric(sev_check)                    0.2823   -30.4742     8.8833     
## AI2AZOX + TEBU 2X:as.numeric(sev_check)  0.0060     9.0509    54.0662   **
## AI2PIRA + METC 1X:as.numeric(sev_check)  0.9354   -10.3953    11.2917     
## AI2PIRA + METC 2X:as.numeric(sev_check)  0.0282     0.8069    14.3070    *
## AI2TEBU 2X:as.numeric(sev_check)         &lt;.0001  -184.5061   -82.5970  ***
## AI2TFLX + PROT 2X:as.numeric(sev_check)  0.1599    -3.1801    19.3047     
## AI2TFLX + TEBU 2X:as.numeric(sev_check)  0.0068     8.5676    53.5798   **
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_sev_check_cont, btt=9:14)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 9:14): 
## QM(df = 6) = 69.1029, p-val &lt; .0001</code></pre>
</div>
<div id="yield_class-1" class="section level3">
<h3>yield_class</h3>
<pre class="r"><code>#Moderator yield_class

summary(fhb_yld_publ$yld_check) # Median = 3002.03; Mean = 2896.47  </code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1283    2579    3263    3395    4398    6048</code></pre>
<pre class="r"><code>fhb_yld_publ &lt;- fhb_yld_publ %&gt;%
  mutate(yld_check_class = case_when(
      yld_check &lt; 3000 ~ &quot;low&quot;,
      yld_check &gt;= 3000 ~ &quot;high&quot;))
table(fhb_yld_publ$AI2, fhb_yld_publ$yld_check_class)</code></pre>
<pre><code>##                 
##                  high low
##   AACHECK          20  13
##   AZOX + TEBU 2X    2   0
##   PIRA + METC 1X   12  11
##   PIRA + METC 2X   19  12
##   TEBU 2X          11   3
##   TFLX + PROT 2X    3   2
##   TFLX + TEBU 2X    2   0</code></pre>
<pre class="r"><code>mv_yld_check &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(yld_check_class),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(yld_check_class),
## random = list(~AI2 | : Redundant predictors dropped from the model.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_check</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 110; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 33)
## inner factor: AI2           (nlvls = 7)
## 
##                  estim      sqrt  k.lvl  fixed           level
## tau^2.1    389843.0193  624.3741     33     no         AACHECK
## tau^2.2    807278.6727  898.4869      2     no  AZOX + TEBU 2X
## tau^2.3    704410.3957  839.2916     23     no  PIRA + METC 1X
## tau^2.4    834780.6709  913.6633     31     no  PIRA + METC 2X
## tau^2.5    727260.6456  852.7958     14     no         TEBU 2X
## tau^2.6    818678.2882  904.8084      5     no  TFLX + PROT 2X
## tau^2.7    769922.6290  877.4524      2     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9552    0.9608    0.9219    0.9190    0.9532
## AZOX + TEBU 2X    0.9552         1    0.0000    0.9952    0.0000    1.0000
## PIRA + METC 1X    0.9608    0.0000         1    0.9643    0.9915    0.9801
## PIRA + METC 2X    0.9219    0.9952    0.9643         1    0.9706    0.9957
## TEBU 2X           0.9190    0.0000    0.9915    0.9706         1    0.0000
## TFLX + PROT 2X    0.9532    1.0000    0.9801    0.9957    0.0000         1
## TFLX + TEBU 2X    0.9552    1.0000    0.0000    0.9952    0.0000    0.9999
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9552       -    no    no    no    no    no    no
## AZOX + TEBU 2X    1.0000       2     -   yes    no   yes    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9952      31     2    23     -    no    no    no
## TEBU 2X           0.0000      14     0    11    12     -   yes   yes
## TFLX + PROT 2X    0.9999       5     2     2     5     0     -    no
## TFLX + TEBU 2X         1       2     2     0     2     0     2     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 98) = 2530.4743, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:12): 
## QM(df = 11) = 146.9307, p-val &lt; .0001
## 
## Model Results:
## 
##                                                 estimate        se
## intrcpt                                        4132.5847  149.6201
## AI2AZOX + TEBU 2X                               798.2534  214.6852
## AI2PIRA + METC 1X                               495.5228   91.3805
## AI2PIRA + METC 2X                               718.0223  115.6118
## AI2TEBU 2X                                      538.2663  115.9584
## AI2TFLX + PROT 2X                               429.4411  208.4983
## AI2TFLX + TEBU 2X                               952.1829  211.7020
## factor(yld_check_class)low                    -1889.9406  233.8433
## AI2PIRA + METC 1X:factor(yld_check_class)low    -52.6799  136.6899
## AI2PIRA + METC 2X:factor(yld_check_class)low   -220.0754  178.0031
## AI2TEBU 2X:factor(yld_check_class)low            37.4523  191.3032
## AI2TFLX + PROT 2X:factor(yld_check_class)low    -24.3746  420.9882
##                                                  zval    pval       ci.lb
## intrcpt                                       27.6205  &lt;.0001   3839.3346
## AI2AZOX + TEBU 2X                              3.7183  0.0002    377.4781
## AI2PIRA + METC 1X                              5.4226  &lt;.0001    316.4203
## AI2PIRA + METC 2X                              6.2106  &lt;.0001    491.4273
## AI2TEBU 2X                                     4.6419  &lt;.0001    310.9921
## AI2TFLX + PROT 2X                              2.0597  0.0394     20.7920
## AI2TFLX + TEBU 2X                              4.4978  &lt;.0001    537.2545
## factor(yld_check_class)low                    -8.0821  &lt;.0001  -2348.2650
## AI2PIRA + METC 1X:factor(yld_check_class)low  -0.3854  0.6999   -320.5873
## AI2PIRA + METC 2X:factor(yld_check_class)low  -1.2364  0.2163   -568.9549
## AI2TEBU 2X:factor(yld_check_class)low          0.1958  0.8448   -337.4950
## AI2TFLX + PROT 2X:factor(yld_check_class)low  -0.0579  0.9538   -849.4963
##                                                    ci.ub     
## intrcpt                                        4425.8348  ***
## AI2AZOX + TEBU 2X                              1219.0287  ***
## AI2PIRA + METC 1X                               674.6253  ***
## AI2PIRA + METC 2X                               944.6173  ***
## AI2TEBU 2X                                      765.5405  ***
## AI2TFLX + PROT 2X                               838.0903    *
## AI2TFLX + TEBU 2X                              1367.1113  ***
## factor(yld_check_class)low                    -1431.6162  ***
## AI2PIRA + METC 1X:factor(yld_check_class)low    215.2274     
## AI2PIRA + METC 2X:factor(yld_check_class)low    128.8042     
## AI2TEBU 2X:factor(yld_check_class)low           412.3996     
## AI2TFLX + PROT 2X:factor(yld_check_class)low    800.7470     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_yld_check, btt=9:14)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 9:12): 
## QM(df = 4) = 3.0382, p-val = 0.5515</code></pre>
</div>
<div id="state-1" class="section level3">
<h3>State</h3>
<pre class="r"><code># Number of entries by fungicide and state
table(fhb_yld_publ$AI2, fhb_yld_publ$state)</code></pre>
<pre><code>##                 
##                  PR RS SC
##   AACHECK         3 29  1
##   AZOX + TEBU 2X  1  0  1
##   PIRA + METC 1X  2 21  0
##   PIRA + METC 2X  3 27  1
##   TEBU 2X         0 14  0
##   TFLX + PROT 2X  3  1  1
##   TFLX + TEBU 2X  1  0  1</code></pre>
<pre class="r"><code>mv_yld_state &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(state),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(state), random =
## list(~AI2 | : Redundant predictors dropped from the model.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_state</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 110; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 33)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1308092.1682  1143.7186     33     no         AACHECK
## tau^2.2        655.6053    25.6048      2     no  AZOX + TEBU 2X
## tau^2.3    1568568.2850  1252.4250     23     no  PIRA + METC 1X
## tau^2.4    1879043.8178  1370.7822     31     no  PIRA + METC 2X
## tau^2.5    1508920.4751  1228.3812     14     no         TEBU 2X
## tau^2.6    1332639.4936  1154.4001      5     no  TFLX + PROT 2X
## tau^2.7       4880.6430    69.8616      2     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1   -0.9999    0.9736    0.9627    0.9531    0.9914
## AZOX + TEBU 2X   -0.9999         1    0.0000   -0.9640    0.0000   -0.9921
## PIRA + METC 1X    0.9736    0.0000         1    0.9858    0.9968    0.9898
## PIRA + METC 2X    0.9627   -0.9640    0.9858         1    0.9857    0.9897
## TEBU 2X           0.9531    0.0000    0.9968    0.9857         1    0.0000
## TFLX + PROT 2X    0.9914   -0.9921    0.9898    0.9897    0.0000         1
## TFLX + TEBU 2X    0.9897   -0.9903    0.0000    0.9914    0.0000    0.9998
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9897       -    no    no    no    no    no    no
## AZOX + TEBU 2X   -0.9903       2     -   yes    no   yes    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9914      31     2    23     -    no    no    no
## TEBU 2X           0.0000      14     0    11    12     -   yes   yes
## TFLX + PROT 2X    0.9998       5     2     2     5     0     -    no
## TFLX + TEBU 2X         1       2     2     0     2     0     2     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 94) = 8572.9702, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:16): 
## QM(df = 15) = 113.2943, p-val &lt; .0001
## 
## Model Results:
## 
##                                      estimate         se     zval    pval
## intrcpt                             2586.2796   688.3966   3.7570  0.0002
## AI2AZOX + TEBU 2X                   2049.8015   736.8484   2.7818  0.0054
## AI2PIRA + METC 1X                    237.2124   416.2556   0.5699  0.5688
## AI2PIRA + METC 2X                    946.7918   359.8326   2.6312  0.0085
## AI2TEBU 2X                           543.9242    94.9629   5.7278  &lt;.0001
## AI2TFLX + PROT 2X                    608.9777   269.0481   2.2635  0.0236
## AI2TFLX + TEBU 2X                   2126.8904   685.9448   3.1007  0.0019
## factor(state)RS                      899.8350   721.7261   1.2468  0.2125
## factor(state)SC                      601.0204  1352.3088   0.4444  0.6567
## AI2PIRA + METC 1X:factor(state)RS    240.3406   422.5159   0.5688  0.5695
## AI2PIRA + METC 2X:factor(state)RS   -325.5489   371.4857  -0.8763  0.3808
## AI2TFLX + PROT 2X:factor(state)RS    268.0816   658.1676   0.4073  0.6838
## AI2AZOX + TEBU 2X:factor(state)SC  -1776.4015  1415.5469  -1.2549  0.2095
## AI2PIRA + METC 2X:factor(state)SC   -735.1918   625.7738  -1.1749  0.2401
## AI2TFLX + PROT 2X:factor(state)SC   -767.5777   434.2991  -1.7674  0.0772
## AI2TFLX + TEBU 2X:factor(state)SC  -1665.1904  1311.0477  -1.2701  0.2040
##                                         ci.lb      ci.ub     
## intrcpt                             1237.0471  3935.5121  ***
## AI2AZOX + TEBU 2X                    605.6052  3493.9978   **
## AI2PIRA + METC 1X                   -578.6336  1053.0583     
## AI2PIRA + METC 2X                    241.5328  1652.0507   **
## AI2TEBU 2X                           357.8003   730.0480  ***
## AI2TFLX + PROT 2X                     81.6531  1136.3024    *
## AI2TFLX + TEBU 2X                    782.4632  3471.3175   **
## factor(state)RS                     -514.7221  2314.3922     
## factor(state)SC                    -2049.4561  3251.4969     
## AI2PIRA + METC 1X:factor(state)RS   -587.7753  1068.4564     
## AI2PIRA + METC 2X:factor(state)RS  -1053.6475   402.5496     
## AI2TFLX + PROT 2X:factor(state)RS  -1021.9031  1558.0663     
## AI2AZOX + TEBU 2X:factor(state)SC  -4550.8224   998.0195     
## AI2PIRA + METC 2X:factor(state)SC  -1961.6859   491.3023     
## AI2TFLX + PROT 2X:factor(state)SC  -1618.7883    83.6328    .
## AI2TFLX + TEBU 2X:factor(state)SC  -4234.7965   904.4158     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># anova(fhb_mv_AI_state,btt=8:15)
# 
# anova(fhb_mv_AI_state,btt=8:11)
# 
# anova(fhb_mv_AI_state,btt=11:15)</code></pre>
</div>
<div id="year-as-continuous-1" class="section level3">
<h3>Year as continuous</h3>
<pre class="r"><code># Number of entries by fungicide and year
table(fhb_yld_publ$AI2, fhb_yld_publ$year)</code></pre>
<pre><code>##                 
##                  2000 2009 2013 2014 2016 2017
##   AACHECK           2    4   13    9    3    2
##   AZOX + TEBU 2X    0    0    2    0    0    0
##   PIRA + METC 1X    0    4   11    8    0    0
##   PIRA + METC 2X    0    4   13    9    3    2
##   TEBU 2X           2    0    7    4    1    0
##   TFLX + PROT 2X    0    0    2    2    0    1
##   TFLX + TEBU 2X    0    0    2    0    0    0</code></pre>
<pre class="r"><code>mv_yld_year &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*as.numeric(year),
  random = list(~AI2 | factor(trial)),
  struct = &quot;HCS&quot;,
  method = &quot;ML&quot;,
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * as.numeric(year), random =
## list(~AI2 | : Redundant predictors dropped from the model.</code></pre>
<pre class="r"><code>mv_yld_year</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 110; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 33)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1269663.1431  1126.7933     33     no         AACHECK
## tau^2.2    1492352.2334  1221.6187      2     no  AZOX + TEBU 2X
## tau^2.3    1548543.4674  1244.4049     23     no  PIRA + METC 1X
## tau^2.4    1780058.3700  1334.1883     31     no  PIRA + METC 2X
## tau^2.5    1554013.7606  1246.6009     14     no         TEBU 2X
## tau^2.6    1395626.3396  1181.3663      5     no  TFLX + PROT 2X
## tau^2.7    1422285.6921  1192.5962      2     no  TFLX + TEBU 2X
## rho              0.9857                       no                
## 
## Test for Residual Heterogeneity: 
## QE(df = 98) = 8303.9232, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:12): 
## QM(df = 11) = 117.4265, p-val &lt; .0001
## 
## Model Results:
## 
##                                         estimate           se     zval
## intrcpt                             -179563.3234  107390.5306  -1.6721
## AI2AZOX + TEBU 2X                       589.9913     226.8341   2.6010
## AI2PIRA + METC 1X                    123277.2158   79648.2985   1.5478
## AI2PIRA + METC 2X                    -83417.6866   80212.2317  -1.0400
## AI2TEBU 2X                            77368.4962   31700.3442   2.4406
## AI2TFLX + PROT 2X                   -340094.1197  329403.7191  -1.0325
## AI2TFLX + TEBU 2X                       764.1777     223.8524   3.4138
## as.numeric(year)                         90.9285      53.3634   1.7039
## AI2PIRA + METC 1X:as.numeric(year)      -61.0425      39.5687  -1.5427
## AI2PIRA + METC 2X:as.numeric(year)       41.7094      39.8473   1.0467
## AI2TEBU 2X:as.numeric(year)             -38.2100      15.7610  -2.4243
## AI2TFLX + PROT 2X:as.numeric(year)      169.0410     163.5910   1.0333
##                                       pval         ci.lb        ci.ub     
## intrcpt                             0.0945  -390044.8957   30918.2489    .
## AI2AZOX + TEBU 2X                   0.0093      145.4047    1034.5779   **
## AI2PIRA + METC 1X                   0.1217   -32830.5807  279385.0122     
## AI2PIRA + METC 2X                   0.2984  -240630.7719   73795.3987     
## AI2TEBU 2X                          0.0147    15236.9632  139500.0292    *
## AI2TFLX + PROT 2X                   0.3019  -985713.5456  305525.3062     
## AI2TFLX + TEBU 2X                   0.0006      325.4352    1202.9203  ***
## as.numeric(year)                    0.0884      -13.6619     195.5189    .
## AI2PIRA + METC 1X:as.numeric(year)  0.1229     -138.5956      16.5107     
## AI2PIRA + METC 2X:as.numeric(year)  0.2952      -36.3898     119.8087     
## AI2TEBU 2X:as.numeric(year)         0.0153      -69.1009      -7.3191    *
## AI2TFLX + PROT 2X:as.numeric(year)  0.3015     -151.5916     489.6735     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="publication-1" class="section level3">
<h3>Publication</h3>
<pre class="r"><code>mv_yld_publication &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(publication),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld_publ
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(publication), random =
## list(~AI2 | : Redundant predictors dropped from the model.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_publication</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 110; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 33)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1086065.7616  1042.1448     33     no         AACHECK
## tau^2.2    1800285.7371  1341.7473      2     no  AZOX + TEBU 2X
## tau^2.3    1379209.6290  1174.3976     23     no  PIRA + METC 1X
## tau^2.4    1561216.4776  1249.4865     31     no  PIRA + METC 2X
## tau^2.5    1333667.0856  1154.8450     14     no         TEBU 2X
## tau^2.6    1957506.2120  1399.1091      5     no  TFLX + PROT 2X
## tau^2.7    1707137.8710  1306.5749      2     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9831    0.9800    0.9632    0.9657    0.9844
## AZOX + TEBU 2X    0.9831         1    0.0000    0.9961    0.0000    1.0000
## PIRA + METC 1X    0.9800    0.0000         1    0.9863    0.9980    0.9936
## PIRA + METC 2X    0.9632    0.9961    0.9863         1    0.9875    0.9954
## TEBU 2X           0.9657    0.0000    0.9980    0.9875         1    0.0000
## TFLX + PROT 2X    0.9844    1.0000    0.9936    0.9954    0.0000         1
## TFLX + TEBU 2X    0.9831    1.0000    0.0000    0.9961    0.0000    1.0000
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9831       -    no    no    no    no    no    no
## AZOX + TEBU 2X    1.0000       2     -   yes    no   yes    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9961      31     2    23     -    no    no    no
## TEBU 2X           0.0000      14     0    11    12     -   yes   yes
## TFLX + PROT 2X    1.0000       5     2     2     5     0     -    no
## TFLX + TEBU 2X         1       2     2     0     2     0     2     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 94) = 8509.7980, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:16): 
## QM(df = 15) = 99.8455, p-val &lt; .0001
## 
## Model Results:
## 
##                                               estimate         se     zval
## intrcpt                                      2415.5764   431.2803   5.6009
## AI2AZOX + TEBU 2X                             623.3742   216.5911   2.8781
## AI2PIRA + METC 1X                             641.6900   187.1526   3.4287
## AI2PIRA + METC 2X                             363.1426   229.3807   1.5831
## AI2TEBU 2X                                    967.4764   243.0468   3.9806
## AI2TFLX + PROT 2X                            1024.6313   392.6174   2.6097
## AI2TFLX + TEBU 2X                             795.0938   212.3826   3.7437
## factor(publication)Resumo                    1117.8507   491.3735   2.2750
## factor(publication)Tese                      1316.6234   621.3342   2.1190
## AI2PIRA + METC 1X:factor(publication)Resumo  -249.2662   200.4584  -1.2435
## AI2PIRA + METC 2X:factor(publication)Resumo   197.7899   248.2761   0.7967
## AI2TEBU 2X:factor(publication)Resumo         -535.5982   260.2350  -2.0581
## AI2TFLX + PROT 2X:factor(publication)Resumo  -797.1344   451.8132  -1.7643
## AI2PIRA + METC 1X:factor(publication)Tese    -323.0824   448.6566  -0.7201
## AI2PIRA + METC 2X:factor(publication)Tese     814.1977   394.5126   2.0638
## AI2TEBU 2X:factor(publication)Tese            443.5042  1014.4135   0.4372
##                                                pval       ci.lb      ci.ub
## intrcpt                                      &lt;.0001   1570.2825  3260.8702
## AI2AZOX + TEBU 2X                            0.0040    198.8635  1047.8850
## AI2PIRA + METC 1X                            0.0006    274.8776  1008.5024
## AI2PIRA + METC 2X                            0.1134    -86.4353   812.7205
## AI2TEBU 2X                                   &lt;.0001    491.1133  1443.8394
## AI2TFLX + PROT 2X                            0.0091    255.1153  1794.1473
## AI2TFLX + TEBU 2X                            0.0002    378.8316  1211.3560
## factor(publication)Resumo                    0.0229    154.7763  2080.9252
## factor(publication)Tese                      0.0341     98.8307  2534.4161
## AI2PIRA + METC 1X:factor(publication)Resumo  0.2137   -642.1575   143.6250
## AI2PIRA + METC 2X:factor(publication)Resumo  0.4257   -288.8223   684.4021
## AI2TEBU 2X:factor(publication)Resumo         0.0396  -1045.6493   -25.5470
## AI2TFLX + PROT 2X:factor(publication)Resumo  0.0777  -1682.6721    88.4032
## AI2PIRA + METC 1X:factor(publication)Tese    0.4715  -1202.4332   556.2684
## AI2PIRA + METC 2X:factor(publication)Tese    0.0390     40.9672  1587.4283
## AI2TEBU 2X:factor(publication)Tese           0.6620  -1544.7097  2431.7181
##                                                 
## intrcpt                                      ***
## AI2AZOX + TEBU 2X                             **
## AI2PIRA + METC 1X                            ***
## AI2PIRA + METC 2X                               
## AI2TEBU 2X                                   ***
## AI2TFLX + PROT 2X                             **
## AI2TFLX + TEBU 2X                            ***
## factor(publication)Resumo                      *
## factor(publication)Tese                        *
## AI2PIRA + METC 1X:factor(publication)Resumo     
## AI2PIRA + METC 2X:factor(publication)Resumo     
## AI2TEBU 2X:factor(publication)Resumo           *
## AI2TFLX + PROT 2X:factor(publication)Resumo    .
## AI2PIRA + METC 1X:factor(publication)Tese       
## AI2PIRA + METC 2X:factor(publication)Tese      *
## AI2TEBU 2X:factor(publication)Tese              
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_yld_publication, btt=10:16)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 10:16): 
## QM(df = 7) = 17.8778, p-val = 0.0125</code></pre>
</div>
</div>
</div>
<div id="overall" class="section level1">
<h1>Overall</h1>
<div id="network-model-1" class="section level2">
<h2>Network model</h2>
</div>
<div id="data-1" class="section level2">
<h2>Data</h2>
<pre class="r"><code>library(readr)
library(tidyverse)
library(janitor)
fhb_yld1 &lt;- read_csv(&quot;data/dat-yld.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   trial = col_double(),
##   year = col_double(),
##   location = col_character(),
##   state = col_character(),
##   cultivar = col_character(),
##   reaction = col_character(),
##   n = col_double(),
##   AI = col_character(),
##   n_spray = col_double(),
##   yld_check = col_double(),
##   sev_check = col_double(),
##   mean_sev = col_double(),
##   publication = col_character(),
##   author = col_character(),
##   cons_group = col_double(),
##   AI2 = col_character(),
##   yld = col_double(),
##   V_yld = col_double(),
##   n2 = col_double()
## )</code></pre>
<pre class="r"><code>target &lt;- c(&quot;check-0&quot;, &quot;Azoxistrobina + Tebuconazole-2&quot;, &quot;Piraclostrobina + Metconazole-2&quot;, &quot;Tebuconazole-2&quot;, &quot;Trifloxistrobina + Protioconazole-2&quot;, &quot;Trifloxistrobina + Tebuconazole-2&quot;, &quot;Piraclostrobina + Metconazole-1&quot;) 
fhb_yld &lt;- fhb_yld1 %&gt;%
  group_by(trial) %&gt;% 
  filter(AI2 %in% target) %&gt;% 
  mutate(n2 = n()) %&gt;% 
  filter(n2 != 1)

# Renaming the treatments 
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;check-0&quot; = &quot;AACHECK&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Azoxistrobina + Tebuconazole-2&quot; = &quot;AZOX + TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Piraclostrobina + Metconazole-2&quot; = &quot;PIRA + METC 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Tebuconazole-2&quot; = &quot;TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Trifloxistrobina + Protioconazole-2&quot; = &quot;TFLX + PROT 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Trifloxistrobina + Tebuconazole-2&quot; = &quot;TFLX + TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Piraclostrobina + Metconazole-1&quot; = &quot;PIRA + METC 1X&quot;))
detach(&quot;package:plyr&quot;, unload = TRUE)


fhb_yld %&gt;%
  tabyl(AI2, publication)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["AI2"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Artigo"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Boletim"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Resumo"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Tese"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"AACHECK","2":"6","3":"36","4":"20","5":"7"},{"1":"AZOX + TEBU 2X","2":"0","3":"23","4":"2","5":"0"},{"1":"PIRA + METC 1X","2":"4","3":"0","4":"17","5":"2"},{"1":"PIRA + METC 2X","2":"4","3":"35","4":"20","5":"7"},{"1":"TEBU 2X","2":"2","3":"11","4":"11","5":"1"},{"1":"TFLX + PROT 2X","2":"0","3":"36","4":"2","5":"3"},{"1":"TFLX + TEBU 2X","2":"0","3":"34","4":"2","5":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="sampling-variance-2" class="section level2">
<h2>Sampling Variance</h2>
<pre class="r"><code># Sampling variance for log of the mean (Paul et al., 2008) to use in multivariate model
fhb_yld &lt;- fhb_yld%&gt;%
  mutate(log_yld = log(yld))

fhb_yld$log_var_yld &lt;- with(fhb_yld, V_yld / (n * yld^2))

# Calculate the variation of absolute yield

fhb_yld$var_yld &lt;- fhb_yld$V_yld/fhb_yld$n # multivariate approach</code></pre>
</div>
<div id="m-a-ai-yld-absolute-2" class="section level2">
<h2>M-A AI (yld Absolute)</h2>
<pre class="r"><code>library(metafor)

mv_yld &lt;- rma.mv(yld, var_yld,
  mods = ~AI2,
  random = list(~AI2 | trial),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>summary(mv_yld)</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 285; method: ML)
## 
##     logLik    Deviance         AIC         BIC        AICc  
## -2074.3355    824.8476   4214.6710   4335.2031   4223.6112  
## 
## Variance Components: 
## 
## outer factor: trial (nlvls = 69)
## inner factor: AI2   (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1285323.7131  1133.7212     69     no         AACHECK
## tau^2.2    1679959.2474  1296.1324     25     no  AZOX + TEBU 2X
## tau^2.3    1548133.9851  1244.2403     23     no  PIRA + METC 1X
## tau^2.4    1739788.6023  1319.0105     66     no  PIRA + METC 2X
## tau^2.5    1566381.6050  1251.5517     25     no         TEBU 2X
## tau^2.6    1664841.0996  1290.2872     41     no  TFLX + PROT 2X
## tau^2.7    1731342.6370  1315.8049     36     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9753    0.9787    0.9716    0.9637    0.9751
## AZOX + TEBU 2X    0.9753         1    0.0000    0.9966    0.9964    0.9934
## PIRA + METC 1X    0.9787    0.0000         1    0.9882    0.9960    0.9965
## PIRA + METC 2X    0.9716    0.9966    0.9882         1    0.9938    0.9940
## TEBU 2X           0.9637    0.9964    0.9960    0.9938         1    0.9968
## TFLX + PROT 2X    0.9751    0.9934    0.9965    0.9940    0.9968         1
## TFLX + TEBU 2X    0.9789    0.9951    0.0000    0.9989    0.9927    0.9963
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9789       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9951      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9989      66    25    23     -    no    no    no
## TEBU 2X           0.9927      25    11    11    23     -    no    no
## TFLX + PROT 2X    0.9963      41    25     2    40    11     -    no
## TFLX + TEBU 2X         1      36    25     0    36    11    36     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 278) = 84948.3758, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:7): 
## QM(df = 6) = 131.8762, p-val &lt; .0001
## 
## Model Results:
## 
##                     estimate        se     zval    pval      ci.lb
## intrcpt            3126.1478  138.4652  22.5771  &lt;.0001  2854.7609
## AI2AZOX + TEBU 2X   465.3908   50.9541   9.1335  &lt;.0001   365.5227
## AI2PIRA + METC 1X   415.2368   54.6680   7.5956  &lt;.0001   308.0896
## AI2PIRA + METC 2X   534.4291   49.3531  10.8287  &lt;.0001   437.6987
## AI2TEBU 2X          449.7739   56.0351   8.0267  &lt;.0001   339.9472
## AI2TFLX + PROT 2X   498.6729   48.5084  10.2801  &lt;.0001   403.5982
## AI2TFLX + TEBU 2X   481.3724   45.8998  10.4875  &lt;.0001   391.4105
##                        ci.ub     
## intrcpt            3397.5346  ***
## AI2AZOX + TEBU 2X   565.2590  ***
## AI2PIRA + METC 1X   522.3841  ***
## AI2PIRA + METC 2X   631.1595  ***
## AI2TEBU 2X          559.6006  ***
## AI2TFLX + PROT 2X   593.7475  ***
## AI2TFLX + TEBU 2X   571.3344  ***
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="contrasts-3" class="section level3">
<h3>Contrasts</h3>
<p>We can set linear contrasts between treatments of interest and get the P-valued using the <code>anova</code> function.</p>
<pre class="r"><code>anova(mv_yld, L = rbind(
 c(0, 1, -1, 0, 0, 0, 0),
  c(0, 1, 0, -1, 0, 0, 0),
  c(0, 1, 0, 0, -1, 0, 0),
  c(0, 1, 0, 0, 0, -1, 0),
  c(0, 1, 0, 0, 0, 0, -1),
  c(0, 0, 1, -1, 0, 0, 0),
  c(0, 0, 1, 0, -1, 0, 0),
  c(0, 0, 1, 0, 0, -1, 0),
  c(0, 0, 1, 0, 0, 0, -1),
  c(0, 0, 0, 1, -1, 0, 0),
  c(0, 0, 0, 1, 0, -1, 0),
  c(0, 0, 0, 1, 0, 0, -1),
  c(0, 0, 0, 0, 1, -1, 0),
  c(0, 0, 0, 0, 1, 0, -1),
  c(0, 0, 0, 0, 0, 1, -1)
))</code></pre>
<pre><code>## 
## Hypotheses:                                             
## 1:  AI2AZOX + TEBU 2X - AI2PIRA + METC 1X = 0
## 2:  AI2AZOX + TEBU 2X - AI2PIRA + METC 2X = 0
## 3:         AI2AZOX + TEBU 2X - AI2TEBU 2X = 0
## 4:  AI2AZOX + TEBU 2X - AI2TFLX + PROT 2X = 0
## 5:  AI2AZOX + TEBU 2X - AI2TFLX + TEBU 2X = 0
## 6:  AI2PIRA + METC 1X - AI2PIRA + METC 2X = 0
## 7:         AI2PIRA + METC 1X - AI2TEBU 2X = 0
## 8:  AI2PIRA + METC 1X - AI2TFLX + PROT 2X = 0
## 9:  AI2PIRA + METC 1X - AI2TFLX + TEBU 2X = 0
## 10:        AI2PIRA + METC 2X - AI2TEBU 2X = 0
## 11: AI2PIRA + METC 2X - AI2TFLX + PROT 2X = 0
## 12: AI2PIRA + METC 2X - AI2TFLX + TEBU 2X = 0
## 13:        AI2TEBU 2X - AI2TFLX + PROT 2X = 0
## 14:        AI2TEBU 2X - AI2TFLX + TEBU 2X = 0
## 15: AI2TFLX + PROT 2X - AI2TFLX + TEBU 2X = 0
## 
## Results:
##      estimate      se    zval   pval
## 1:    50.1540 54.1981  0.9254 0.3548
## 2:   -69.0383 32.9966 -2.0923 0.0364
## 3:    15.6170 41.0614  0.3803 0.7037
## 4:   -33.2820 40.4062 -0.8237 0.4101
## 5:   -15.9816 38.1335 -0.4191 0.6751
## 6:  -119.1923 50.0163 -2.3831 0.0172
## 7:   -34.5371 52.6057 -0.6565 0.5115
## 8:   -83.4361 53.2163 -1.5679 0.1169
## 9:   -66.1356 50.9249 -1.2987 0.1941
## 10:   84.6552 40.4384  2.0934 0.0363
## 11:   35.7562 33.2277  1.0761 0.2819
## 12:   53.0567 21.2704  2.4944 0.0126
## 13:  -48.8990 40.3335 -1.2124 0.2254
## 14:  -31.5986 42.5786 -0.7421 0.4580
## 15:   17.3004 29.3263  0.5899 0.5552</code></pre>
<pre class="r"><code>yield = data.frame(mv_yld$b, mv_yld$ci.lb, mv_yld$ci.ub) %&gt;%
  rownames_to_column(&quot;trat&quot;) %&gt;%
  separate(trat, into = c(&quot;lixo&quot;,&quot;lado1&quot;),sep = &quot;AI2&quot; ) %&gt;%
  filter(lixo!= &quot;intrcpt&quot;) %&gt;% 
  select(-lixo) %&gt;%
  set_names(&quot;fungicide&quot;, &quot;yld&quot;, &quot;yld_inf&quot;, &quot;yld_sup&quot;)</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 1 rows [1].</code></pre>
<pre class="r"><code>yield</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["fungicide"],"name":[1],"type":["chr"],"align":["left"]},{"label":["yld"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["yld_inf"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["yld_sup"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"AZOX + TEBU 2X","2":"465.3908","3":"365.5227","4":"565.2590"},{"1":"PIRA + METC 1X","2":"415.2368","3":"308.0896","4":"522.3841"},{"1":"PIRA + METC 2X","2":"534.4291","3":"437.6987","4":"631.1595"},{"1":"TEBU 2X","2":"449.7739","3":"339.9472","4":"559.6006"},{"1":"TFLX + PROT 2X","2":"498.6729","3":"403.5982","4":"593.7475"},{"1":"TFLX + TEBU 2X","2":"481.3724","3":"391.4105","4":"571.3344"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>library(readr)
write_csv(yield, &quot;data/yld-response.csv&quot;)</code></pre>
</div>
</div>
<div id="m-a-ai-relative-yld-1" class="section level2">
<h2>M-A AI (Relative yld)</h2>
<pre class="r"><code>mv_yld_relative &lt;- rma.mv(log_yld, log_var_yld,
  mods = ~AI2,
  random = list(~AI2 | trial),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>summary(mv_yld_relative)</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 285; method: ML)
## 
##    logLik   Deviance        AIC        BIC       AICc  
##  201.6359   852.1949  -337.2717  -216.7396  -328.3315  
## 
## Variance Components: 
## 
## outer factor: trial (nlvls = 69)
## inner factor: AI2   (nlvls = 7)
## 
##             estim    sqrt  k.lvl  fixed           level
## tau^2.1    0.2938  0.5421     69     no         AACHECK
## tau^2.2    0.3010  0.5486     25     no  AZOX + TEBU 2X
## tau^2.3    0.2847  0.5335     23     no  PIRA + METC 1X
## tau^2.4    0.2770  0.5263     66     no  PIRA + METC 2X
## tau^2.5    0.2645  0.5143     25     no         TEBU 2X
## tau^2.6    0.2638  0.5136     41     no  TFLX + PROT 2X
## tau^2.7    0.3084  0.5553     36     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9900    0.9917    0.9873    0.9849    0.9872
## AZOX + TEBU 2X    0.9900         1    0.0000    0.9973    0.9982    0.9956
## PIRA + METC 1X    0.9917    0.0000         1    0.9936    0.9982    0.9973
## PIRA + METC 2X    0.9873    0.9973    0.9936         1    0.9964    0.9965
## TEBU 2X           0.9849    0.9982    0.9982    0.9964         1    0.9984
## TFLX + PROT 2X    0.9872    0.9956    0.9973    0.9965    0.9984         1
## TFLX + TEBU 2X    0.9902    0.9970    0.0000    0.9996    0.9963    0.9976
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9902       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9970      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9996      66    25    23     -    no    no    no
## TEBU 2X           0.9963      25    11    11    23     -    no    no
## TFLX + PROT 2X    0.9976      41    25     2    40    11     -    no
## TFLX + TEBU 2X         1      36    25     0    36    11    36     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 278) = 25856.8609, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:7): 
## QM(df = 6) = 156.1144, p-val &lt; .0001
## 
## Model Results:
## 
##                    estimate      se      zval    pval   ci.lb   ci.ub     
## intrcpt              7.9585  0.0657  121.1538  &lt;.0001  7.8298  8.0873  ***
## AI2AZOX + TEBU 2X    0.1380  0.0148    9.3048  &lt;.0001  0.1089  0.1671  ***
## AI2PIRA + METC 1X    0.1224  0.0153    7.9990  &lt;.0001  0.0924  0.1524  ***
## AI2PIRA + METC 2X    0.1585  0.0135   11.7552  &lt;.0001  0.1321  0.1850  ***
## AI2TEBU 2X           0.1375  0.0162    8.5078  &lt;.0001  0.1058  0.1692  ***
## AI2TFLX + PROT 2X    0.1513  0.0148   10.2184  &lt;.0001  0.1223  0.1803  ***
## AI2TFLX + TEBU 2X    0.1396  0.0133   10.4931  &lt;.0001  0.1135  0.1657  ***
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>results_relative_yld&lt;- data.frame(cbind((exp(mv_yld_relative$b)-1)*100, 
                             (exp(mv_yld_relative$ci.lb)-1)*100,
                             (exp(mv_yld_relative$ci.ub)-1)*100))
results_relative_yld</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["X3"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"285885.86629","2":"2.513372e+05","3":"325181.63133","_rn_":"intrcpt"},{"1":"14.79814","2":"1.150905e+01","3":"18.18424","_rn_":"AI2AZOX + TEBU 2X"},{"1":"13.01743","2":"9.678987e+00","3":"16.45748","_rn_":"AI2PIRA + METC 1X"},{"1":"17.18067","2":"1.412361e+01","3":"20.31962","_rn_":"AI2PIRA + METC 2X"},{"1":"14.74062","2":"1.116292e+01","3":"18.43347","_rn_":"AI2TEBU 2X"},{"1":"16.33324","2":"1.300597e+01","3":"19.75849","_rn_":"AI2TFLX + PROT 2X"},{"1":"14.98413","2":"1.202412e+01","3":"18.02235","_rn_":"AI2TFLX + TEBU 2X"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="moderator-analysis-2" class="section level2">
<h2>Moderator analysis</h2>
<div id="cultivar-2" class="section level3">
<h3>Cultivar</h3>
<pre class="r"><code># creating two groups of cultivars (MR, S)
table(fhb_yld$cultivar, fhb_yld$reaction)</code></pre>
<pre><code>##                      
##                       MR MS MS/MR MS/S  S
##   Abalone              0  0     4    0  0
##   Ametista             0  8     0    0  0
##   BRS Grauna           0  0     0    5  0
##   BRS208               0 89     0    0  0
##   BRS23                0  4     0    0  0
##   BRSGuabijú           0  5     0    0  0
##   BRSGuamirim          3  0     0    0  0
##   Campeiro             0 14     0    0  0
##   Campo Real           0  0     0    0  0
##   CD105                0  0     0    0  5
##   Celebra              0  0     4    0  0
##   Fundacep Bravo       0  8     0    0  0
##   Fundacep46 Nova Era  0  6     0    0  0
##   Linhagem 01/14       0  0     0    0  0
##   Marfim               0  0     0    8  0
##   Mirante              0  0     0    0  8
##   Quartzo              0  4     0    0  0
##   Raízes               0  0     0    0  0
##   Supera               0  0     0    0  0
##   Taurum               0  0     0    0  8
##   TBIO Alvorada        8  0     0    0  0
##   TBIO Itaipu          0  6     0    0  0
##   Tbio Mestre          0  4     0    0  0
##   TBIO Pioneiro        0  0     0    0  0
##   Tbio Sinuelo         0 14     0    0  0
##   TBIO Toruk           0 26     0    0  0
##   TEC 02/13            0  0     0    0  0
##   TEC 10               0  9     0    0  0
##   Vigore               0  0     0    0  0</code></pre>
<pre class="r"><code>nrow(table(fhb_yld$cultivar, fhb_yld$reaction))</code></pre>
<pre><code>## [1] 29</code></pre>
<pre class="r"><code># Renaming the reactions 
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld$reaction &lt;- revalue(fhb_yld$reaction, c(&quot;MS&quot; = &quot;S&quot;))
fhb_yld$reaction &lt;- revalue(fhb_yld$reaction, c(&quot;MS/MR&quot; = &quot;MR&quot;))
fhb_yld$reaction &lt;- revalue(fhb_yld$reaction, c(&quot;MR/R&quot; = &quot;MR&quot;))</code></pre>
<pre><code>## The following `from` values were not present in `x`: MR/R</code></pre>
<pre class="r"><code>fhb_yld$reaction &lt;- revalue(fhb_yld$reaction, c(&quot;MS/S&quot; = &quot;S&quot;))
detach(&quot;package:plyr&quot;, unload = TRUE)</code></pre>
<pre><code>## Warning: &#39;plyr&#39; namespace cannot be unloaded:
##   namespace &#39;plyr&#39; is imported by &#39;ggplot2&#39; so cannot be unloaded</code></pre>
<pre class="r"><code>table(fhb_yld$cultivar, fhb_yld$reaction)</code></pre>
<pre><code>##                      
##                       MR  S
##   Abalone              4  0
##   Ametista             0  8
##   BRS Grauna           0  5
##   BRS208               0 89
##   BRS23                0  4
##   BRSGuabijú           0  5
##   BRSGuamirim          3  0
##   Campeiro             0 14
##   Campo Real           0  0
##   CD105                0  5
##   Celebra              4  0
##   Fundacep Bravo       0  8
##   Fundacep46 Nova Era  0  6
##   Linhagem 01/14       0  0
##   Marfim               0  8
##   Mirante              0  8
##   Quartzo              0  4
##   Raízes               0  0
##   Supera               0  0
##   Taurum               0  8
##   TBIO Alvorada        8  0
##   TBIO Itaipu          0  6
##   Tbio Mestre          0  4
##   TBIO Pioneiro        0  0
##   Tbio Sinuelo         0 14
##   TBIO Toruk           0 26
##   TEC 02/13            0  0
##   TEC 10               0  9
##   Vigore               0  0</code></pre>
<pre class="r"><code>table(fhb_yld$reaction)</code></pre>
<pre><code>## 
##  MR   S 
##  19 231</code></pre>
<pre class="r"><code>table(fhb_yld$AI2, fhb_yld$reaction)</code></pre>
<pre><code>##                 
##                  MR  S
##   AACHECK         5 53
##   AZOX + TEBU 2X  0 25
##   PIRA + METC 1X  4 12
##   PIRA + METC 2X  5 50
##   TEBU 2X         3 22
##   TFLX + PROT 2X  1 37
##   TFLX + TEBU 2X  1 32</code></pre>
<pre class="r"><code>mv_yld_reaction &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*reaction,
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * reaction, random = list(~AI2
## | : Rows with NAs omitted from model fitting.</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * reaction, random = list(~AI2
## | : Redundant predictors dropped from the model.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_reaction</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 250; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 58)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1343229.3392  1158.9777     58     no         AACHECK
## tau^2.2    1805563.1738  1343.7125     25     no  AZOX + TEBU 2X
## tau^2.3    1779949.8065  1334.1476     16     no  PIRA + METC 1X
## tau^2.4    1868240.8411  1366.8361     55     no  PIRA + METC 2X
## tau^2.5    1717627.4100  1310.5829     25     no         TEBU 2X
## tau^2.6    1815846.2041  1347.5334     38     no  TFLX + PROT 2X
## tau^2.7    1856009.4432  1362.3544     33     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9758    0.9782    0.9723    0.9659    0.9793
## AZOX + TEBU 2X    0.9758         1    0.0000    0.9971    0.9971    0.9942
## PIRA + METC 1X    0.9782    0.0000         1    0.9947    0.9985    0.9983
## PIRA + METC 2X    0.9723    0.9971    0.9947         1    0.9951    0.9948
## TEBU 2X           0.9659    0.9971    0.9985    0.9951         1    0.9964
## TFLX + PROT 2X    0.9793    0.9942    0.9983    0.9948    0.9964         1
## TFLX + TEBU 2X    0.9791    0.9951    0.0000    0.9986    0.9942    0.9978
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9791       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9951      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      16     0     -    no    no    no   yes
## PIRA + METC 2X    0.9986      55    25    16     -    no    no    no
## TEBU 2X           0.9942      25    11    11    23     -    no    no
## TFLX + PROT 2X    0.9978      38    25     2    37    11     -    no
## TFLX + TEBU 2X         1      33    25     0    33    11    33     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 237) = 74793.5923, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:13): 
## QM(df = 12) = 121.4836, p-val &lt; .0001
## 
## Model Results:
## 
##                               estimate        se     zval    pval
## intrcpt                      3337.9018  526.7249   6.3371  &lt;.0001
## AI2AZOX + TEBU 2X             496.5223   57.6917   8.6065  &lt;.0001
## AI2PIRA + METC 1X             497.9194  191.9122   2.5945  0.0095
## AI2PIRA + METC 2X             731.8218  205.8314   3.5554  0.0004
## AI2TEBU 2X                    538.9833  217.6973   2.4758  0.0133
## AI2TFLX + PROT 2X             569.0034  446.7760   1.2736  0.2028
## AI2TFLX + TEBU 2X             543.8789  441.0227   1.2332  0.2175
## reactionS                    -153.1318  550.9717  -0.2779  0.7811
## AI2PIRA + METC 1X:reactionS   -86.5494  204.7846  -0.4226  0.6726
## AI2PIRA + METC 2X:reactionS  -156.6582  214.0395  -0.7319  0.4642
## AI2TEBU 2X:reactionS          -56.2996  226.8996  -0.2481  0.8040
## AI2TFLX + PROT 2X:reactionS   -37.8235  450.0510  -0.0840  0.9330
## AI2TFLX + TEBU 2X:reactionS   -35.0140  444.3626  -0.0788  0.9372
##                                   ci.lb      ci.ub     
## intrcpt                       2305.5399  4370.2636  ***
## AI2AZOX + TEBU 2X              383.4486   609.5961  ***
## AI2PIRA + METC 1X              121.7785   874.0603   **
## AI2PIRA + METC 2X              328.3996  1135.2440  ***
## AI2TEBU 2X                     112.3044   965.6622    *
## AI2TFLX + PROT 2X             -306.6615  1444.6682     
## AI2TFLX + TEBU 2X             -320.5097  1408.2676     
## reactionS                    -1233.0164   926.7529     
## AI2PIRA + METC 1X:reactionS   -487.9198   314.8209     
## AI2PIRA + METC 2X:reactionS   -576.1679   262.8516     
## AI2TEBU 2X:reactionS          -501.0147   388.4154     
## AI2TFLX + PROT 2X:reactionS   -919.9073   844.2602     
## AI2TFLX + TEBU 2X:reactionS   -905.9487   835.9207     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#anova(mv_yld_reaction, btt=9:14)</code></pre>
</div>
<div id="disease-pressure-2" class="section level3">
<h3>Disease Pressure</h3>
<pre class="r"><code>library(tidyverse)
fhb_yld &lt;- fhb_yld %&gt;%
  mutate(sev_check_class = case_when(
      sev_check &lt; 7 ~ &quot;low&quot;,
      sev_check &gt;= 7 ~ &quot;high&quot;))

mv_dis_press &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(sev_check_class),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(sev_check_class),
## random = list(~AI2 | : Rows with NAs omitted from model fitting.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_dis_press</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 237; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 57)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1124227.4511  1060.2959     57     no         AACHECK
## tau^2.2    1424019.7605  1193.3230     25     no  AZOX + TEBU 2X
## tau^2.3     847536.0835   920.6172     12     no  PIRA + METC 1X
## tau^2.4    1459418.2990  1208.0639     54     no  PIRA + METC 2X
## tau^2.5    1363264.8149  1167.5893     14     no         TEBU 2X
## tau^2.6    1430069.5523  1195.8552     40     no  TFLX + PROT 2X
## tau^2.7    1479003.5403  1216.1429     35     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9795    0.9895    0.9809    0.9641    0.9794
## AZOX + TEBU 2X    0.9795         1    0.0000    0.9972    0.9930    0.9921
## PIRA + METC 1X    0.9895    0.0000         1    0.9440    0.0000    0.9455
## PIRA + METC 2X    0.9809    0.9972    0.9440         1    0.9951    0.9940
## TEBU 2X           0.9641    0.9930    0.0000    0.9951         1    0.9960
## TFLX + PROT 2X    0.9794    0.9921    0.9455    0.9940    0.9960         1
## TFLX + TEBU 2X    0.9853    0.9949    0.0000    0.9992    0.9939    0.9958
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9853       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9949      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      12     0     -    no   yes    no   yes
## PIRA + METC 2X    0.9992      54    25    12     -    no    no    no
## TEBU 2X           0.9939      14    11     0    12     -    no    no
## TFLX + PROT 2X    0.9958      40    25     2    39    11     -    no
## TFLX + TEBU 2X         1      35    25     0    35    11    35     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 223) = 68210.7839, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:14): 
## QM(df = 13) = 241.9248, p-val &lt; .0001
## 
## Model Results:
## 
##                                                estimate        se     zval
## intrcpt                                       2710.8099  196.6630  13.7840
## AI2AZOX + TEBU 2X                              438.3015   69.0472   6.3479
## AI2PIRA + METC 1X                              317.9647  151.4923   2.0989
## AI2PIRA + METC 2X                              537.3794   61.2319   8.7761
## AI2TEBU 2X                                     416.4655   82.4858   5.0489
## AI2TFLX + PROT 2X                              502.6095   63.3254   7.9369
## AI2TFLX + TEBU 2X                              490.6104   57.6685   8.5074
## factor(sev_check_class)low                     560.6204  285.9113   1.9608
## AI2AZOX + TEBU 2X:factor(sev_check_class)low   -71.5552   98.5772  -0.7259
## AI2PIRA + METC 1X:factor(sev_check_class)low  -146.7839  161.8227  -0.9071
## AI2PIRA + METC 2X:factor(sev_check_class)low  -148.0453   87.5659  -1.6907
## AI2TEBU 2X:factor(sev_check_class)low           29.1178  124.5629   0.2338
## AI2TFLX + PROT 2X:factor(sev_check_class)low  -120.6456   94.7877  -1.2728
## AI2TFLX + TEBU 2X:factor(sev_check_class)low  -131.5843   85.4486  -1.5399
##                                                 pval      ci.lb      ci.ub
## intrcpt                                       &lt;.0001  2325.3575  3096.2622
## AI2AZOX + TEBU 2X                             &lt;.0001   302.9715   573.6316
## AI2PIRA + METC 1X                             0.0358    21.0453   614.8841
## AI2PIRA + METC 2X                             &lt;.0001   417.3670   657.3917
## AI2TEBU 2X                                    &lt;.0001   254.7962   578.1348
## AI2TFLX + PROT 2X                             &lt;.0001   378.4939   626.7250
## AI2TFLX + TEBU 2X                             &lt;.0001   377.5821   603.6386
## factor(sev_check_class)low                    0.0499     0.2445  1120.9962
## AI2AZOX + TEBU 2X:factor(sev_check_class)low  0.4679  -264.7629   121.6525
## AI2PIRA + METC 1X:factor(sev_check_class)low  0.3644  -463.9506   170.3829
## AI2PIRA + METC 2X:factor(sev_check_class)low  0.0909  -319.6713    23.5806
## AI2TEBU 2X:factor(sev_check_class)low         0.8152  -215.0211   273.2567
## AI2TFLX + PROT 2X:factor(sev_check_class)low  0.2031  -306.4262    65.1349
## AI2TFLX + TEBU 2X:factor(sev_check_class)low  0.1236  -299.0605    35.8920
##                                                  
## intrcpt                                       ***
## AI2AZOX + TEBU 2X                             ***
## AI2PIRA + METC 1X                               *
## AI2PIRA + METC 2X                             ***
## AI2TEBU 2X                                    ***
## AI2TFLX + PROT 2X                             ***
## AI2TFLX + TEBU 2X                             ***
## factor(sev_check_class)low                      *
## AI2AZOX + TEBU 2X:factor(sev_check_class)low     
## AI2PIRA + METC 1X:factor(sev_check_class)low     
## AI2PIRA + METC 2X:factor(sev_check_class)low    .
## AI2TEBU 2X:factor(sev_check_class)low            
## AI2TFLX + PROT 2X:factor(sev_check_class)low     
## AI2TFLX + TEBU 2X:factor(sev_check_class)low     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_dis_press, btt=9:14)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 9:14): 
## QM(df = 6) = 9.7561, p-val = 0.1353</code></pre>
</div>
<div id="sev_check-as-continuous-2" class="section level3">
<h3>Sev_check as continuous</h3>
<pre class="r"><code>mv_sev_check_cont &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*as.numeric(sev_check),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * as.numeric(sev_check), random
## = list(~AI2 | : Rows with NAs omitted from model fitting.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_sev_check_cont</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 237; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 57)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1042245.5443  1020.9043     57     no         AACHECK
## tau^2.2    1386302.5507  1177.4135     25     no  AZOX + TEBU 2X
## tau^2.3     761565.6812   872.6773     12     no  PIRA + METC 1X
## tau^2.4    1385123.6256  1176.9128     54     no  PIRA + METC 2X
## tau^2.5    1613977.4599  1270.4241     14     no         TEBU 2X
## tau^2.6    1393926.0689  1180.6465     40     no  TFLX + PROT 2X
## tau^2.7    1462489.0507  1209.3341     35     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9805    0.9861    0.9795    0.9861    0.9819
## AZOX + TEBU 2X    0.9805         1    0.0000    0.9961    0.9991    0.9906
## PIRA + METC 1X    0.9861    0.0000         1    0.9335    0.0000    0.9467
## PIRA + METC 2X    0.9795    0.9961    0.9335         1    0.9943    0.9938
## TEBU 2X           0.9861    0.9991    0.0000    0.9943         1    0.9883
## TFLX + PROT 2X    0.9819    0.9906    0.9467    0.9938    0.9883         1
## TFLX + TEBU 2X    0.9852    0.9946    0.0000    0.9993    0.9938    0.9950
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9852       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9946      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      12     0     -    no   yes    no   yes
## PIRA + METC 2X    0.9993      54    25    12     -    no    no    no
## TEBU 2X           0.9938      14    11     0    12     -    no    no
## TFLX + PROT 2X    0.9950      40    25     2    39    11     -    no
## TFLX + TEBU 2X         1      35    25     0    35    11    35     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 223) = 33286.0352, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:14): 
## QM(df = 13) = 252.7366, p-val &lt; .0001
## 
## Model Results:
## 
##                                           estimate        se     zval
## intrcpt                                  3233.9766  170.3172  18.9880
## AI2AZOX + TEBU 2X                         382.5998   60.3859   6.3359
## AI2PIRA + METC 1X                         157.6578   59.6458   2.6432
## AI2PIRA + METC 2X                         423.0526   54.3696   7.7811
## AI2TEBU 2X                                348.7162   74.3355   4.6911
## AI2TFLX + PROT 2X                         379.5777   57.3245   6.6216
## AI2TFLX + TEBU 2X                         384.5140   55.0899   6.9798
## as.numeric(sev_check)                     -13.9806    5.4923  -2.5455
## AI2AZOX + TEBU 2X:as.numeric(sev_check)     1.3991    1.9055   0.7342
## AI2PIRA + METC 1X:as.numeric(sev_check)     1.0206    5.3950   0.1892
## AI2PIRA + METC 2X:as.numeric(sev_check)     1.8170    1.8092   1.0043
## AI2TEBU 2X:as.numeric(sev_check)            6.5376    2.7388   2.3870
## AI2TFLX + PROT 2X:as.numeric(sev_check)     2.7865    1.8206   1.5305
## AI2TFLX + TEBU 2X:as.numeric(sev_check)     2.2163    1.7382   1.2751
##                                            pval      ci.lb      ci.ub     
## intrcpt                                  &lt;.0001  2900.1610  3567.7921  ***
## AI2AZOX + TEBU 2X                        &lt;.0001   264.2456   500.9540  ***
## AI2PIRA + METC 1X                        0.0082    40.7543   274.5614   **
## AI2PIRA + METC 2X                        &lt;.0001   316.4902   529.6150  ***
## AI2TEBU 2X                               &lt;.0001   203.0212   494.4112  ***
## AI2TFLX + PROT 2X                        &lt;.0001   267.2238   491.9316  ***
## AI2TFLX + TEBU 2X                        &lt;.0001   276.5397   492.4882  ***
## as.numeric(sev_check)                    0.0109   -24.7453    -3.2159    *
## AI2AZOX + TEBU 2X:as.numeric(sev_check)  0.4628    -2.3356     5.1338     
## AI2PIRA + METC 1X:as.numeric(sev_check)  0.8500    -9.5533    11.5945     
## AI2PIRA + METC 2X:as.numeric(sev_check)  0.3152    -1.7289     5.3629     
## AI2TEBU 2X:as.numeric(sev_check)         0.0170     1.1697    11.9056    *
## AI2TFLX + PROT 2X:as.numeric(sev_check)  0.1259    -0.7818     6.3548     
## AI2TFLX + TEBU 2X:as.numeric(sev_check)  0.2023    -1.1905     5.6231     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_sev_check_cont, btt=9:14)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 9:14): 
## QM(df = 6) = 7.8575, p-val = 0.2487</code></pre>
</div>
<div id="yield_class-2" class="section level3">
<h3>yield_class</h3>
<pre class="r"><code>#Moderator yield_class

summary(fhb_yld$yld_check) # Median = 3002.03; Mean = 2896.47  </code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   67.33 2148.90 3053.00 3059.51 3755.75 6048.00</code></pre>
<pre class="r"><code>fhb_yld &lt;- fhb_yld %&gt;%
  mutate(yld_check_class = case_when(
      yld_check &lt; 3000 ~ &quot;low&quot;,
      yld_check &gt;= 3000 ~ &quot;high&quot;))
table(fhb_yld$AI2, fhb_yld$yld_check_class)</code></pre>
<pre><code>##                 
##                  high low
##   AACHECK          39  30
##   AZOX + TEBU 2X   14  11
##   PIRA + METC 1X   12  11
##   PIRA + METC 2X   37  29
##   TEBU 2X          17   8
##   TFLX + PROT 2X   22  19
##   TFLX + TEBU 2X   19  17</code></pre>
<pre class="r"><code>mv_yld_check &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(yld_check_class),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_check</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 285; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 69)
## inner factor: AI2           (nlvls = 7)
## 
##                  estim      sqrt  k.lvl  fixed           level
## tau^2.1    441547.7219  664.4906     69     no         AACHECK
## tau^2.2    723707.4798  850.7100     25     no  AZOX + TEBU 2X
## tau^2.3    724497.3243  851.1741     23     no  PIRA + METC 1X
## tau^2.4    754053.4233  868.3625     66     no  PIRA + METC 2X
## tau^2.5    717224.9399  846.8913     25     no         TEBU 2X
## tau^2.6    691664.8045  831.6639     41     no  TFLX + PROT 2X
## tau^2.7    693214.8857  832.5953     36     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9491    0.9683    0.9382    0.9276    0.9405
## AZOX + TEBU 2X    0.9491         1    0.0000    0.9919    0.9925    0.9846
## PIRA + METC 1X    0.9683    0.0000         1    0.9705    0.9865    0.9874
## PIRA + METC 2X    0.9382    0.9919    0.9705         1    0.9872    0.9869
## TEBU 2X           0.9276    0.9925    0.9865    0.9872         1    0.9950
## TFLX + PROT 2X    0.9405    0.9846    0.9874    0.9869    0.9950         1
## TFLX + TEBU 2X    0.9475    0.9908    0.0000    0.9992    0.9872    0.9902
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9475       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9908      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9992      66    25    23     -    no    no    no
## TEBU 2X           0.9872      25    11    11    23     -    no    no
## TFLX + PROT 2X    0.9902      41    25     2    40    11     -    no
## TFLX + TEBU 2X         1      36    25     0    36    11    36     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 271) = 33689.3115, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:14): 
## QM(df = 13) = 285.8709, p-val &lt; .0001
## 
## Model Results:
## 
##                                                 estimate        se
## intrcpt                                        3900.3194  111.4063
## AI2AZOX + TEBU 2X                               528.1848   70.8988
## AI2PIRA + METC 1X                               414.6307   72.9995
## AI2PIRA + METC 2X                               602.1650   66.2487
## AI2TEBU 2X                                      466.1277   75.6862
## AI2TFLX + PROT 2X                               560.0728   66.8333
## AI2TFLX + TEBU 2X                               587.1364   63.9939
## factor(yld_check_class)low                    -1803.5343  166.7775
## AI2AZOX + TEBU 2X:factor(yld_check_class)low   -132.4928  100.5134
## AI2PIRA + METC 1X:factor(yld_check_class)low    -28.4270  106.4105
## AI2PIRA + METC 2X:factor(yld_check_class)low   -147.7087   96.5898
## AI2TEBU 2X:factor(yld_check_class)low           -38.0217  111.0808
## AI2TFLX + PROT 2X:factor(yld_check_class)low   -142.5320   96.2580
## AI2TFLX + TEBU 2X:factor(yld_check_class)low   -240.8636   90.1144
##                                                   zval    pval       ci.lb
## intrcpt                                        35.0099  &lt;.0001   3681.9671
## AI2AZOX + TEBU 2X                               7.4498  &lt;.0001    389.2258
## AI2PIRA + METC 1X                               5.6799  &lt;.0001    271.5544
## AI2PIRA + METC 2X                               9.0895  &lt;.0001    472.3198
## AI2TEBU 2X                                      6.1587  &lt;.0001    317.7854
## AI2TFLX + PROT 2X                               8.3801  &lt;.0001    429.0820
## AI2TFLX + TEBU 2X                               9.1749  &lt;.0001    461.7106
## factor(yld_check_class)low                    -10.8140  &lt;.0001  -2130.4122
## AI2AZOX + TEBU 2X:factor(yld_check_class)low   -1.3182  0.1874   -329.4955
## AI2PIRA + METC 1X:factor(yld_check_class)low   -0.2671  0.7894   -236.9878
## AI2PIRA + METC 2X:factor(yld_check_class)low   -1.5292  0.1262   -337.0212
## AI2TEBU 2X:factor(yld_check_class)low          -0.3423  0.7321   -255.7360
## AI2TFLX + PROT 2X:factor(yld_check_class)low   -1.4807  0.1387   -331.1943
## AI2TFLX + TEBU 2X:factor(yld_check_class)low   -2.6729  0.0075   -417.4845
##                                                    ci.ub     
## intrcpt                                        4118.6717  ***
## AI2AZOX + TEBU 2X                               667.1439  ***
## AI2PIRA + METC 1X                               557.7070  ***
## AI2PIRA + METC 2X                               732.0101  ***
## AI2TEBU 2X                                      614.4699  ***
## AI2TFLX + PROT 2X                               691.0637  ***
## AI2TFLX + TEBU 2X                               712.5621  ***
## factor(yld_check_class)low                    -1476.6564  ***
## AI2AZOX + TEBU 2X:factor(yld_check_class)low     64.5098     
## AI2PIRA + METC 1X:factor(yld_check_class)low    180.1338     
## AI2PIRA + METC 2X:factor(yld_check_class)low     41.6038     
## AI2TEBU 2X:factor(yld_check_class)low           179.6926     
## AI2TFLX + PROT 2X:factor(yld_check_class)low     46.1303     
## AI2TFLX + TEBU 2X:factor(yld_check_class)low    -64.2426   **
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_yld_check, btt=9:14)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 9:14): 
## QM(df = 6) = 12.9049, p-val = 0.0446</code></pre>
</div>
<div id="state-2" class="section level3">
<h3>State</h3>
<pre class="r"><code># Number of entries by fungicide and state
table(fhb_yld$AI2, fhb_yld$state)</code></pre>
<pre><code>##                 
##                  PR RS SC
##   AACHECK        15 52  2
##   AZOX + TEBU 2X  9 14  2
##   PIRA + METC 1X  2 21  0
##   PIRA + METC 2X 15 49  2
##   TEBU 2X         4 20  1
##   TFLX + PROT 2X 15 24  2
##   TFLX + TEBU 2X 13 21  2</code></pre>
<pre class="r"><code>mv_yld_state &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(state),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(state), random =
## list(~AI2 | : Redundant predictors dropped from the model.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_state</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 285; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 69)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1227422.1020  1107.8908     69     no         AACHECK
## tau^2.2    1651803.8556  1285.2252     25     no  AZOX + TEBU 2X
## tau^2.3    1465656.3363  1210.6429     23     no  PIRA + METC 1X
## tau^2.4    1686269.5659  1298.5644     66     no  PIRA + METC 2X
## tau^2.5    1476423.0092  1215.0815     25     no         TEBU 2X
## tau^2.6    1625991.2908  1275.1436     41     no  TFLX + PROT 2X
## tau^2.7    1701017.1544  1304.2305     36     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9754    0.9774    0.9718    0.9614    0.9766
## AZOX + TEBU 2X    0.9754         1    0.0000    0.9962    0.9964    0.9926
## PIRA + METC 1X    0.9774    0.0000         1    0.9881    0.9959    0.9955
## PIRA + METC 2X    0.9718    0.9962    0.9881         1    0.9931    0.9934
## TEBU 2X           0.9614    0.9964    0.9959    0.9931         1    0.9946
## TFLX + PROT 2X    0.9766    0.9926    0.9955    0.9934    0.9946         1
## TFLX + TEBU 2X    0.9792    0.9952    0.0000    0.9991    0.9914    0.9956
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9792       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9952      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9991      66    25    23     -    no    no    no
## TEBU 2X           0.9914      25    11    11    23     -    no    no
## TFLX + PROT 2X    0.9956      41    25     2    40    11     -    no
## TFLX + TEBU 2X         1      36    25     0    36    11    36     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 265) = 63346.5438, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:20): 
## QM(df = 19) = 149.2789, p-val &lt; .0001
## 
## Model Results:
## 
##                                     estimate        se     zval    pval
## intrcpt                            2716.6312  289.5451   9.3824  &lt;.0001
## AI2AZOX + TEBU 2X                   440.3844  102.6684   4.2894  &lt;.0001
## AI2PIRA + METC 1X                    25.0819  358.7361   0.0699  0.9443
## AI2PIRA + METC 2X                   500.5516  103.9813   4.8139  &lt;.0001
## AI2TEBU 2X                          489.8607  124.3300   3.9400  &lt;.0001
## AI2TFLX + PROT 2X                   448.4163   95.6636   4.6874  &lt;.0001
## AI2TFLX + TEBU 2X                   477.6079   94.6042   5.0485  &lt;.0001
## factor(state)RS                     507.5829  328.9455   1.5431  0.1228
## factor(state)SC                     990.4042  844.3673   1.1730  0.2408
## AI2AZOX + TEBU 2X:factor(state)RS    60.9526  119.9654   0.5081  0.6114
## AI2PIRA + METC 1X:factor(state)RS   406.6701  363.3689   1.1192  0.2631
## AI2PIRA + METC 2X:factor(state)RS    60.8732  118.3922   0.5142  0.6071
## AI2TEBU 2X:factor(state)RS          -35.0177  140.0269  -0.2501  0.8025
## AI2TFLX + PROT 2X:factor(state)RS    97.3706  111.6477   0.8721  0.3831
## AI2TFLX + TEBU 2X:factor(state)RS    14.3197  109.6054   0.1306  0.8961
## AI2AZOX + TEBU 2X:factor(state)SC  -290.5319  301.5919  -0.9633  0.3354
## AI2PIRA + METC 2X:factor(state)SC  -358.1723  315.2878  -1.1360  0.2559
## AI2TEBU 2X:factor(state)SC         -373.2009  343.3624  -1.0869  0.2771
## AI2TFLX + PROT 2X:factor(state)SC  -416.9798  292.9583  -1.4233  0.1546
## AI2TFLX + TEBU 2X:factor(state)SC  -268.5076  295.6191  -0.9083  0.3637
##                                         ci.lb      ci.ub     
## intrcpt                             2149.1333  3284.1291  ***
## AI2AZOX + TEBU 2X                    239.1579   641.6108  ***
## AI2PIRA + METC 1X                   -678.0280   728.1918     
## AI2PIRA + METC 2X                    296.7520   704.3511  ***
## AI2TEBU 2X                           246.1784   733.5430  ***
## AI2TFLX + PROT 2X                    260.9191   635.9134  ***
## AI2TFLX + TEBU 2X                    292.1870   663.0288  ***
## factor(state)RS                     -137.1384  1152.3041     
## factor(state)SC                     -664.5253  2645.3336     
## AI2AZOX + TEBU 2X:factor(state)RS   -174.1753   296.0805     
## AI2PIRA + METC 1X:factor(state)RS   -305.5198  1118.8599     
## AI2PIRA + METC 2X:factor(state)RS   -171.1712   292.9177     
## AI2TEBU 2X:factor(state)RS          -309.4654   239.4301     
## AI2TFLX + PROT 2X:factor(state)RS   -121.4550   316.1961     
## AI2TFLX + TEBU 2X:factor(state)RS   -200.5030   229.1424     
## AI2AZOX + TEBU 2X:factor(state)SC   -881.6411   300.5774     
## AI2PIRA + METC 2X:factor(state)SC   -976.1250   259.7804     
## AI2TEBU 2X:factor(state)SC         -1046.1788   299.7770     
## AI2TFLX + PROT 2X:factor(state)SC   -991.1675   157.2078     
## AI2TFLX + TEBU 2X:factor(state)SC   -847.9105   310.8952     
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="year-as-continuous-2" class="section level3">
<h3>Year as continuous</h3>
<pre class="r"><code># Number of entries by fungicide and year
table(fhb_yld$AI2, fhb_yld$year)</code></pre>
<pre><code>##                 
##                  2000 2009 2011 2012 2013 2014 2015 2016 2017 2018
##   AACHECK           2    4    7    6   19   14    1    3    8    5
##   AZOX + TEBU 2X    0    0    7    5    8    5    0    0    0    0
##   PIRA + METC 1X    0    4    0    0   11    8    0    0    0    0
##   PIRA + METC 2X    0    4    7    6   19   14    1    3    8    4
##   TEBU 2X           2    0    7    0    7    8    0    1    0    0
##   TFLX + PROT 2X    0    0    7    6    8    7    1    0    7    5
##   TFLX + TEBU 2X    0    0    7    5    8    5    1    0    6    4</code></pre>
<pre class="r"><code>mv_yld_year &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*as.numeric(year),
  random = list(~AI2 | factor(trial)),
  struct = &quot;HCS&quot;,
  method = &quot;ML&quot;,
  data = fhb_yld
)

mv_yld_year</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 285; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 69)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1312752.0110  1145.7539     69     no         AACHECK
## tau^2.2    1674272.1467  1293.9367     25     no  AZOX + TEBU 2X
## tau^2.3    1547434.7184  1243.9593     23     no  PIRA + METC 1X
## tau^2.4    1707491.2190  1306.7101     66     no  PIRA + METC 2X
## tau^2.5    1577120.7202  1255.8347     25     no         TEBU 2X
## tau^2.6    1654976.4302  1286.4589     41     no  TFLX + PROT 2X
## tau^2.7    1772686.6509  1331.4228     36     no  TFLX + TEBU 2X
## rho              0.9912                       no                
## 
## Test for Residual Heterogeneity: 
## QE(df = 271) = 78207.6522, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:14): 
## QM(df = 13) = 260.5721, p-val &lt; .0001
## 
## Model Results:
## 
##                                        estimate          se     zval
## intrcpt                             -41312.2557  86522.9807  -0.4775
## AI2AZOX + TEBU 2X                    27956.2053  70318.1525   0.3976
## AI2PIRA + METC 1X                   141130.5600  64503.3202   2.1880
## AI2PIRA + METC 2X                   -48925.3899  30603.0781  -1.5987
## AI2TEBU 2X                           75514.6672  26052.9096   2.8985
## AI2TFLX + PROT 2X                   -35780.9326  32060.1959  -1.1161
## AI2TFLX + TEBU 2X                   -37804.1078  34156.6001  -1.1068
## as.numeric(year)                        22.0827     42.9766   0.5138
## AI2AZOX + TEBU 2X:as.numeric(year)     -13.6893     34.9419  -0.3918
## AI2PIRA + METC 1X:as.numeric(year)     -69.9300     32.0433  -2.1824
## AI2PIRA + METC 2X:as.numeric(year)      24.5390     15.1989   1.6145
## AI2TEBU 2X:as.numeric(year)            -37.3174     12.9506  -2.8815
## AI2TFLX + PROT 2X:as.numeric(year)      17.9962     15.9210   1.1303
## AI2TFLX + TEBU 2X:as.numeric(year)      19.0042     16.9622   1.1204
##                                       pval         ci.lb        ci.ub    
## intrcpt                             0.6330  -210894.1817  128269.6702    
## AI2AZOX + TEBU 2X                   0.6909  -109864.8410  165777.2517    
## AI2PIRA + METC 1X                   0.0287    14706.3756  267554.7444   *
## AI2PIRA + METC 2X                   0.1099  -108906.3208   11055.5410    
## AI2TEBU 2X                          0.0037    24451.9028  126577.4317  **
## AI2TFLX + PROT 2X                   0.2644   -98617.7620   27055.8968    
## AI2TFLX + TEBU 2X                   0.2684  -104749.8139   29141.5983    
## as.numeric(year)                    0.6074      -62.1499     106.3154    
## AI2AZOX + TEBU 2X:as.numeric(year)  0.6952      -82.1741      54.7955    
## AI2PIRA + METC 1X:as.numeric(year)  0.0291     -132.7337      -7.1262   *
## AI2PIRA + METC 2X:as.numeric(year)  0.1064       -5.2503      54.3284    
## AI2TEBU 2X:as.numeric(year)         0.0040      -62.7002     -11.9346  **
## AI2TFLX + PROT 2X:as.numeric(year)  0.2583      -13.2084      49.2009    
## AI2TFLX + TEBU 2X:as.numeric(year)  0.2625      -14.2410      52.2495    
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_yld_year, btt=9:14)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 9:14): 
## QM(df = 6) = 19.5268, p-val = 0.0034</code></pre>
</div>
<div id="publication-2" class="section level3">
<h3>Publication</h3>
<pre class="r"><code># Renaming the treatments 
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld$publication &lt;- revalue(fhb_yld$publication, c(&quot;Boletim&quot; = &quot;AABoletim&quot;))
detach(&quot;package:plyr&quot;, unload = TRUE)</code></pre>
<pre><code>## Warning: &#39;plyr&#39; namespace cannot be unloaded:
##   namespace &#39;plyr&#39; is imported by &#39;ggplot2&#39; so cannot be unloaded</code></pre>
<pre class="r"><code>mv_yld_publication &lt;- rma.mv(yld, var_yld,
  mods = ~AI2*factor(publication),
  random = list(~AI2 | factor(trial)),
  struct = &quot;UN&quot;,
  method = &quot;ML&quot;,
  control = list(optimizer = &quot;nlm&quot;),
  data = fhb_yld
)</code></pre>
<pre><code>## Warning in rma.mv(yld, var_yld, mods = ~AI2 * factor(publication), random =
## list(~AI2 | : Redundant predictors dropped from the model.</code></pre>
<pre><code>## Warning in .process.G.afterrmna(mf.g, g.nlevels, g.levels, struct[1],
## tau2, : Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<pre class="r"><code>mv_yld_publication</code></pre>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 285; method: ML)
## 
## Variance Components: 
## 
## outer factor: factor(trial) (nlvls = 69)
## inner factor: AI2           (nlvls = 7)
## 
##                   estim       sqrt  k.lvl  fixed           level
## tau^2.1    1089186.0175  1043.6408     69     no         AACHECK
## tau^2.2    1405729.8584  1185.6348     25     no  AZOX + TEBU 2X
## tau^2.3    1350613.5583  1162.1590     23     no  PIRA + METC 1X
## tau^2.4    1456690.1604  1206.9342     66     no  PIRA + METC 2X
## tau^2.5    1329289.9270  1152.9484     25     no         TEBU 2X
## tau^2.6    1414479.6699  1189.3190     41     no  TFLX + PROT 2X
## tau^2.7    1449968.7645  1204.1465     36     no  TFLX + TEBU 2X
## 
##                 rho.AACH  rho.A+T2  rho.P+M1  rho.P+M2  rho.TEB2  rho.T+P2
## AACHECK                1    0.9750    0.9818    0.9708    0.9677    0.9743
## AZOX + TEBU 2X    0.9750         1    0.0000    0.9960    0.9973    0.9929
## PIRA + METC 1X    0.9818    0.0000         1    0.9889    0.9968    0.9962
## PIRA + METC 2X    0.9708    0.9960    0.9889         1    0.9940    0.9936
## TEBU 2X           0.9677    0.9973    0.9968    0.9940         1    0.9973
## TFLX + PROT 2X    0.9743    0.9929    0.9962    0.9936    0.9973         1
## TFLX + TEBU 2X    0.9783    0.9942    0.0000    0.9987    0.9934    0.9962
##                 rho.T+T2    AACH  A+T2  P+M1  P+M2  TEB2  T+P2  T+T2
## AACHECK           0.9783       -    no    no    no    no    no    no
## AZOX + TEBU 2X    0.9942      25     -   yes    no    no    no    no
## PIRA + METC 1X    0.0000      23     0     -    no    no    no   yes
## PIRA + METC 2X    0.9987      66    25    23     -    no    no    no
## TEBU 2X           0.9934      25    11    11    23     -    no    no
## TFLX + PROT 2X    0.9962      41    25     2    40    11     -    no
## TFLX + TEBU 2X         1      36    25     0    36    11    36     -
## 
## Test for Residual Heterogeneity: 
## QE(df = 263) = 76953.9003, p-val &lt; .0001
## 
## Test of Moderators (coefficient(s) 2:22): 
## QM(df = 21) = 183.1372, p-val &lt; .0001
## 
## Model Results:
## 
##                                               estimate        se     zval
## intrcpt                                      2868.3575  175.7465  16.3210
## AI2AZOX + TEBU 2X                             402.2002   58.7432   6.8467
## AI2PIRA + METC 1X                             338.3321  405.7468   0.8339
## AI2PIRA + METC 2X                             471.1534   60.4314   7.7965
## AI2TEBU 2X                                    390.1142   67.2144   5.8040
## AI2TFLX + PROT 2X                             451.6520   56.7505   7.9586
## AI2TFLX + TEBU 2X                             417.2601   54.4908   7.6574
## factor(publication)Artigo                    -451.4185  466.2618  -0.9682
## factor(publication)Resumo                     671.1628  294.0560   2.2824
## factor(publication)Tese                       872.2139  481.0381   1.8132
## AI2PIRA + METC 1X:factor(publication)Artigo   299.0873  444.6454   0.6726
## AI2PIRA + METC 2X:factor(publication)Artigo  -121.4321  217.0648  -0.5594
## AI2TEBU 2X:factor(publication)Artigo          577.0214  246.5474   2.3404
## AI2AZOX + TEBU 2X:factor(publication)Resumo   201.1254  224.1500   0.8973
## AI2PIRA + METC 1X:factor(publication)Resumo    49.0991  411.5307   0.1193
## AI2PIRA + METC 2X:factor(publication)Resumo    72.2673  103.1087   0.7009
## AI2TEBU 2X:factor(publication)Resumo           30.0275  112.7943   0.2662
## AI2TFLX + PROT 2X:factor(publication)Resumo  -249.1201  229.5698  -1.0852
## AI2TFLX + TEBU 2X:factor(publication)Resumo   363.0364  215.7455   1.6827
## AI2PIRA + METC 2X:factor(publication)Tese     690.7779  317.2005   2.1777
## AI2TEBU 2X:factor(publication)Tese            987.6836  987.2209   1.0005
## AI2TFLX + PROT 2X:factor(publication)Tese     312.2440  376.4180   0.8295
##                                                pval       ci.lb      ci.ub
## intrcpt                                      &lt;.0001   2523.9007  3212.8142
## AI2AZOX + TEBU 2X                            &lt;.0001    287.0656   517.3348
## AI2PIRA + METC 1X                            0.4044   -456.9170  1133.5812
## AI2PIRA + METC 2X                            &lt;.0001    352.7100   589.5968
## AI2TEBU 2X                                   &lt;.0001    258.3765   521.8520
## AI2TFLX + PROT 2X                            &lt;.0001    340.4230   562.8810
## AI2TFLX + TEBU 2X                            &lt;.0001    310.4602   524.0601
## factor(publication)Artigo                    0.3330  -1365.2749   462.4379
## factor(publication)Resumo                    0.0225     94.8237  1247.5019
## factor(publication)Tese                      0.0698    -70.6034  1815.0312
## AI2PIRA + METC 1X:factor(publication)Artigo  0.5012   -572.4017  1170.5762
## AI2PIRA + METC 2X:factor(publication)Artigo  0.5759   -546.8713   304.0071
## AI2TEBU 2X:factor(publication)Artigo         0.0193     93.7974  1060.2453
## AI2AZOX + TEBU 2X:factor(publication)Resumo  0.3696   -238.2005   640.4512
## AI2PIRA + METC 1X:factor(publication)Resumo  0.9050   -757.4863   855.6844
## AI2PIRA + METC 2X:factor(publication)Resumo  0.4834   -129.8221   274.3567
## AI2TEBU 2X:factor(publication)Resumo         0.7901   -191.0453   251.1003
## AI2TFLX + PROT 2X:factor(publication)Resumo  0.2779   -699.0685   200.8284
## AI2TFLX + TEBU 2X:factor(publication)Resumo  0.0924    -59.8171   785.8898
## AI2PIRA + METC 2X:factor(publication)Tese    0.0294     69.0763  1312.4795
## AI2TEBU 2X:factor(publication)Tese           0.3171   -947.2338  2922.6011
## AI2TFLX + PROT 2X:factor(publication)Tese    0.4068   -425.5216  1050.0097
##                                                 
## intrcpt                                      ***
## AI2AZOX + TEBU 2X                            ***
## AI2PIRA + METC 1X                               
## AI2PIRA + METC 2X                            ***
## AI2TEBU 2X                                   ***
## AI2TFLX + PROT 2X                            ***
## AI2TFLX + TEBU 2X                            ***
## factor(publication)Artigo                       
## factor(publication)Resumo                      *
## factor(publication)Tese                        .
## AI2PIRA + METC 1X:factor(publication)Artigo     
## AI2PIRA + METC 2X:factor(publication)Artigo     
## AI2TEBU 2X:factor(publication)Artigo           *
## AI2AZOX + TEBU 2X:factor(publication)Resumo     
## AI2PIRA + METC 1X:factor(publication)Resumo     
## AI2PIRA + METC 2X:factor(publication)Resumo     
## AI2TEBU 2X:factor(publication)Resumo            
## AI2TFLX + PROT 2X:factor(publication)Resumo     
## AI2TFLX + TEBU 2X:factor(publication)Resumo    .
## AI2PIRA + METC 2X:factor(publication)Tese      *
## AI2TEBU 2X:factor(publication)Tese              
## AI2TFLX + PROT 2X:factor(publication)Tese       
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(mv_yld_publication, btt=11:22)</code></pre>
<pre><code>## 
## Test of Moderators (coefficient(s) 11:22): 
## QM(df = 12) = 26.1765, p-val = 0.0101</code></pre>
</div>
</div>
<div id="network-graph" class="section level2">
<h2>Network Graph</h2>
<p>First we will rename the treatments with the number of trials (within parenthesis) that each treatment was present.</p>
<pre class="r"><code>library(readr)
library(tidyverse)
library(janitor)
fhb_yld &lt;- read_csv(&quot;data/dat-yld.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   trial = col_double(),
##   year = col_double(),
##   location = col_character(),
##   state = col_character(),
##   cultivar = col_character(),
##   reaction = col_character(),
##   n = col_double(),
##   AI = col_character(),
##   n_spray = col_double(),
##   yld_check = col_double(),
##   sev_check = col_double(),
##   mean_sev = col_double(),
##   publication = col_character(),
##   author = col_character(),
##   cons_group = col_double(),
##   AI2 = col_character(),
##   yld = col_double(),
##   V_yld = col_double(),
##   n2 = col_double()
## )</code></pre>
<pre class="r"><code>fhb_yld = fhb_yld %&gt;% 
  filter(AI2 != &quot;Tebuconazole-1&quot;)

# Renaming the treatments
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;check-0&quot; = &quot;AACHECK&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Azoxistrobina + Tebuconazole-2&quot; = &quot;AZOX + TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Piraclostrobina + Metconazole-2&quot; = &quot;PIRA + METC 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Tebuconazole-2&quot; = &quot;TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Trifloxistrobina + Protioconazole-2&quot; = &quot;TFLX + PROT 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Trifloxistrobina + Tebuconazole-2&quot; = &quot;TFLX + TEBU 2X&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;Piraclostrobina + Metconazole-1&quot; = &quot;PIRA + METC 1X&quot;))
detach(&quot;package:plyr&quot;, unload = TRUE)


fhb_yld %&gt;%
tabyl(AI2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["AI2"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"AACHECK","2":"69","3":"0.24210526"},{"1":"AZOX + TEBU 2X","2":"25","3":"0.08771930"},{"1":"PIRA + METC 1X","2":"23","3":"0.08070175"},{"1":"PIRA + METC 2X","2":"66","3":"0.23157895"},{"1":"TEBU 2X","2":"25","3":"0.08771930"},{"1":"TFLX + PROT 2X","2":"41","3":"0.14385965"},{"1":"TFLX + TEBU 2X","2":"36","3":"0.12631579"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Renaming the treatments for the network graph
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;AACHECK&quot; = &quot;CHECK (69)&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;AZOX + TEBU 2X&quot; = &quot;AZOX + TEBU 2 (25)&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;PIRA + METC 2X&quot; = &quot;PIRA + METC 2X (66)&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;TEBU 2X&quot; = &quot;TEBU 2X (25)&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;TFLX + PROT 2X&quot; = &quot;TFLX + PROT 2X (41)&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;TFLX + TEBU 2X&quot; = &quot;TFLX + TEBU 2X (36)&quot;))
fhb_yld$AI2 &lt;- revalue(fhb_yld$AI2, c(&quot;PIRA + METC 1X&quot; = &quot;PIRA + METC 1X (23)&quot;))
detach(&quot;package:plyr&quot;, unload = TRUE)</code></pre>
<p>We need to prepare the data to get the network graph. Thus, we used the package <code>netmeta</code> with the function <code>pairwise</code> to calculate the contrasts.</p>
<pre class="r"><code>library(netmeta)



pair_yld &lt;- pairwise(
  treat = factor(AI2),
  n = 4,
  mean = yld,
  sd = V_yld,
  studlab = trial,
  data = fhb_yld,
  sm = &quot;ROM&quot;
)</code></pre>
<pre class="r"><code>net_yld &lt;- netmeta(TE, seTE, treat1, treat2, studlab, data = pair_yld, sm = &quot;MD&quot;)
summary(net_yld)</code></pre>
<pre><code>## Number of studies: k = 69
## Number of treatments: n = 7
## Number of pairwise comparisons: m = 495
## Number of designs: d = 11
## 
## Fixed effects model
## 
## Treatment estimate (sm = &#39;MD&#39;):
##                     AZOX + TEBU 2 (25) CHECK (69) PIRA + METC 1X (23)
## AZOX + TEBU 2 (25)                   .     0.1046              0.0037
## CHECK (69)                     -0.1046          .             -0.1009
## PIRA + METC 1X (23)            -0.0037     0.1009                   .
## PIRA + METC 2X (66)             0.0258     0.1304              0.0295
## TEBU 2X (25)                    0.0102     0.1148              0.0139
## TFLX + PROT 2X (41)             0.0380     0.1426              0.0417
## TFLX + TEBU 2X (36)             0.0088     0.1134              0.0125
##                     PIRA + METC 2X (66) TEBU 2X (25) TFLX + PROT 2X (41)
## AZOX + TEBU 2 (25)              -0.0258      -0.0102             -0.0380
## CHECK (69)                      -0.1304      -0.1148             -0.1426
## PIRA + METC 1X (23)             -0.0295      -0.0139             -0.0417
## PIRA + METC 2X (66)                   .       0.0156             -0.0122
## TEBU 2X (25)                    -0.0156            .             -0.0278
## TFLX + PROT 2X (41)              0.0122       0.0278                   .
## TFLX + TEBU 2X (36)             -0.0170      -0.0014             -0.0292
##                     TFLX + TEBU 2X (36)
## AZOX + TEBU 2 (25)              -0.0088
## CHECK (69)                      -0.1134
## PIRA + METC 1X (23)             -0.0125
## PIRA + METC 2X (66)              0.0170
## TEBU 2X (25)                     0.0014
## TFLX + PROT 2X (41)              0.0292
## TFLX + TEBU 2X (36)                   .
## 
## Lower 95%-confidence limit:
##                     AZOX + TEBU 2 (25) CHECK (69) PIRA + METC 1X (23)
## AZOX + TEBU 2 (25)                   .    -2.8958             -3.4581
## CHECK (69)                     -3.1050          .             -2.3975
## PIRA + METC 1X (23)            -3.4654    -2.1957                   .
## PIRA + METC 2X (66)            -2.8897    -1.7256             -2.1889
## TEBU 2X (25)                   -3.5998    -3.0288             -3.5277
## TFLX + PROT 2X (41)            -3.0451    -2.4143             -3.0442
## TFLX + TEBU 2X (36)            -3.1097    -2.4889             -3.1119
##                     PIRA + METC 2X (66) TEBU 2X (25) TFLX + PROT 2X (41)
## AZOX + TEBU 2 (25)              -2.9414      -3.6203             -3.1211
## CHECK (69)                      -1.9865      -3.2584             -2.6995
## PIRA + METC 1X (23)             -2.2480      -3.5556             -3.1276
## PIRA + METC 2X (66)                   .      -3.0831             -2.4614
## TEBU 2X (25)                    -3.1143            .             -3.3921
## TFLX + PROT 2X (41)             -2.4370      -3.3365                   .
## TFLX + TEBU 2X (36)             -2.5156      -3.3976             -2.7091
##                     TFLX + TEBU 2X (36)
## AZOX + TEBU 2 (25)              -3.1274
## CHECK (69)                      -2.7158
## PIRA + METC 1X (23)             -3.1370
## PIRA + METC 2X (66)             -2.4817
## TEBU 2X (25)                    -3.3948
## TFLX + PROT 2X (41)             -2.6508
## TFLX + TEBU 2X (36)                   .
## 
## Upper 95%-confidence limit:
##                     AZOX + TEBU 2 (25) CHECK (69) PIRA + METC 1X (23)
## AZOX + TEBU 2 (25)                   .     3.1050              3.4654
## CHECK (69)                      2.8958          .              2.1957
## PIRA + METC 1X (23)             3.4581     2.3975                   .
## PIRA + METC 2X (66)             2.9414     1.9865              2.2480
## TEBU 2X (25)                    3.6203     3.2584              3.5556
## TFLX + PROT 2X (41)             3.1211     2.6995              3.1276
## TFLX + TEBU 2X (36)             3.1274     2.7158              3.1370
##                     PIRA + METC 2X (66) TEBU 2X (25) TFLX + PROT 2X (41)
## AZOX + TEBU 2 (25)               2.8897       3.5998              3.0451
## CHECK (69)                       1.7256       3.0288              2.4143
## PIRA + METC 1X (23)              2.1889       3.5277              3.0442
## PIRA + METC 2X (66)                   .       3.1143              2.4370
## TEBU 2X (25)                     3.0831            .              3.3365
## TFLX + PROT 2X (41)              2.4614       3.3921                   .
## TFLX + TEBU 2X (36)              2.4817       3.3948              2.6508
##                     TFLX + TEBU 2X (36)
## AZOX + TEBU 2 (25)               3.1097
## CHECK (69)                       2.4889
## PIRA + METC 1X (23)              3.1119
## PIRA + METC 2X (66)              2.5156
## TEBU 2X (25)                     3.3976
## TFLX + PROT 2X (41)              2.7091
## TFLX + TEBU 2X (36)                   .
## 
## Random effects model
## 
## Treatment estimate (sm = &#39;MD&#39;):
##                     AZOX + TEBU 2 (25) CHECK (69) PIRA + METC 1X (23)
## AZOX + TEBU 2 (25)                   .     0.1046              0.0037
## CHECK (69)                     -0.1046          .             -0.1009
## PIRA + METC 1X (23)            -0.0037     0.1009                   .
## PIRA + METC 2X (66)             0.0258     0.1304              0.0295
## TEBU 2X (25)                    0.0102     0.1148              0.0139
## TFLX + PROT 2X (41)             0.0380     0.1426              0.0417
## TFLX + TEBU 2X (36)             0.0088     0.1134              0.0125
##                     PIRA + METC 2X (66) TEBU 2X (25) TFLX + PROT 2X (41)
## AZOX + TEBU 2 (25)              -0.0258      -0.0102             -0.0380
## CHECK (69)                      -0.1304      -0.1148             -0.1426
## PIRA + METC 1X (23)             -0.0295      -0.0139             -0.0417
## PIRA + METC 2X (66)                   .       0.0156             -0.0122
## TEBU 2X (25)                    -0.0156            .             -0.0278
## TFLX + PROT 2X (41)              0.0122       0.0278                   .
## TFLX + TEBU 2X (36)             -0.0170      -0.0014             -0.0292
##                     TFLX + TEBU 2X (36)
## AZOX + TEBU 2 (25)              -0.0088
## CHECK (69)                      -0.1134
## PIRA + METC 1X (23)             -0.0125
## PIRA + METC 2X (66)              0.0170
## TEBU 2X (25)                     0.0014
## TFLX + PROT 2X (41)              0.0292
## TFLX + TEBU 2X (36)                   .
## 
## Lower 95%-confidence limit:
##                     AZOX + TEBU 2 (25) CHECK (69) PIRA + METC 1X (23)
## AZOX + TEBU 2 (25)                   .    -2.8958             -3.4581
## CHECK (69)                     -3.1050          .             -2.3975
## PIRA + METC 1X (23)            -3.4654    -2.1957                   .
## PIRA + METC 2X (66)            -2.8897    -1.7256             -2.1889
## TEBU 2X (25)                   -3.5998    -3.0288             -3.5277
## TFLX + PROT 2X (41)            -3.0451    -2.4143             -3.0442
## TFLX + TEBU 2X (36)            -3.1097    -2.4889             -3.1119
##                     PIRA + METC 2X (66) TEBU 2X (25) TFLX + PROT 2X (41)
## AZOX + TEBU 2 (25)              -2.9414      -3.6203             -3.1211
## CHECK (69)                      -1.9865      -3.2584             -2.6995
## PIRA + METC 1X (23)             -2.2480      -3.5556             -3.1276
## PIRA + METC 2X (66)                   .      -3.0831             -2.4614
## TEBU 2X (25)                    -3.1143            .             -3.3921
## TFLX + PROT 2X (41)             -2.4370      -3.3365                   .
## TFLX + TEBU 2X (36)             -2.5156      -3.3976             -2.7091
##                     TFLX + TEBU 2X (36)
## AZOX + TEBU 2 (25)              -3.1274
## CHECK (69)                      -2.7158
## PIRA + METC 1X (23)             -3.1370
## PIRA + METC 2X (66)             -2.4817
## TEBU 2X (25)                    -3.3948
## TFLX + PROT 2X (41)             -2.6508
## TFLX + TEBU 2X (36)                   .
## 
## Upper 95%-confidence limit:
##                     AZOX + TEBU 2 (25) CHECK (69) PIRA + METC 1X (23)
## AZOX + TEBU 2 (25)                   .     3.1050              3.4654
## CHECK (69)                      2.8958          .              2.1957
## PIRA + METC 1X (23)             3.4581     2.3975                   .
## PIRA + METC 2X (66)             2.9414     1.9865              2.2480
## TEBU 2X (25)                    3.6203     3.2584              3.5556
## TFLX + PROT 2X (41)             3.1211     2.6995              3.1276
## TFLX + TEBU 2X (36)             3.1274     2.7158              3.1370
##                     PIRA + METC 2X (66) TEBU 2X (25) TFLX + PROT 2X (41)
## AZOX + TEBU 2 (25)               2.8897       3.5998              3.0451
## CHECK (69)                       1.7256       3.0288              2.4143
## PIRA + METC 1X (23)              2.1889       3.5277              3.0442
## PIRA + METC 2X (66)                   .       3.1143              2.4370
## TEBU 2X (25)                     3.0831            .              3.3365
## TFLX + PROT 2X (41)              2.4614       3.3921                   .
## TFLX + TEBU 2X (36)              2.4817       3.3948              2.6508
##                     TFLX + TEBU 2X (36)
## AZOX + TEBU 2 (25)               3.1097
## CHECK (69)                       2.4889
## PIRA + METC 1X (23)              3.1119
## PIRA + METC 2X (66)              2.5156
## TEBU 2X (25)                     3.3976
## TFLX + PROT 2X (41)              2.7091
## TFLX + TEBU 2X (36)                   .
## 
## Quantifying heterogeneity / inconsistency:
## tau^2 = 0; I^2 = 0%
## 
## Tests of heterogeneity (within designs) and inconsistency (between designs):
##                    Q d.f. p-value
## Total           0.02  210  1.0000
## Within designs  0.02  189  1.0000
## Between designs 0.00   21  1.0000</code></pre>
<p>A network graph is composed of nodes (fungicide treatments) and edges or links between two treatments directly compared in a same trial. This graph allows to visualize how the treatments relate to each other and the number of direct comparisons can be depicted by the thickness of the edges, but also with numbers presented at the top of the links.</p>
<pre class="r"><code>#pdf(&quot;Figures/net_yld.pdf&quot;, width=10, height=6)
netgraph(net_yld,
  plastic = FALSE,
  col = &quot;gray&quot;,
  thickness = &quot;number.of.studies&quot;,
  points = TRUE,
  col.points = &quot;black&quot;,
  cex.points = c(&quot;AZOX + TEBU 2 (25)&quot; = 2.2, &quot;CHECK (69)&quot; = 6, &quot;PIRA + METC 1X (23)&quot; = 2, &quot;PIRA + METC 2X (66)&quot; = 5.7, &quot;TEBU 2X (25)&quot; = 2.2,  &quot;TFLX + PROT 2X (41)&quot; = 3.6,  &quot;TFLX + TEBU 2X (36)&quot; = 3.1),
  number.of.studies = TRUE,
  cex.number.of.studies = 1.25,
  col.number.of.studies = &quot;black&quot;,
  bg.number.of.studies = &quot;white&quot;,
  multiarm = FALSE,
  col.multiarm = &quot;gray&quot;,
  pos.number.of.studies = 0.50)</code></pre>
<p><img src="code-yld_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre class="r"><code>#dev.off()</code></pre>
</div>
<div id="designs" class="section level2">
<h2>Designs</h2>
<pre class="r"><code>yld_design &lt;- decomp.design(net_yld)
yld_design$Q.inc.detach</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["design"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Q"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"CHECK (69):PIRA + METC 2X (66)","2":"0.002516173","3":"20","4":"1","_rn_":"1"},{"1":"CHECK (69):TEBU 2X (25)","2":"0.001807283","3":"20","4":"1","_rn_":"2"},{"1":"CHECK (69):TFLX + PROT 2X (41)","2":"0.002519606","3":"20","4":"1","_rn_":"3"},{"1":"AZOX + TEBU 2 (25):CHECK (69):PIRA + METC 2X (66):TEBU 2X (25):TFLX + PROT 2X (41):TFLX + TEBU 2X (36)","2":"0.001566979","3":"16","4":"1","_rn_":"4"},{"1":"AZOX + TEBU 2 (25):CHECK (69):PIRA + METC 2X (66):TFLX + PROT 2X (41):TFLX + TEBU 2X (36)","2":"0.001906657","3":"17","4":"1","_rn_":"9"},{"1":"CHECK (69):PIRA + METC 1X (23):PIRA + METC 2X (66)","2":"0.001418250","3":"19","4":"1","_rn_":"13"},{"1":"CHECK (69):PIRA + METC 1X (23):PIRA + METC 2X (66):TEBU 2X (25)","2":"0.002485009","3":"18","4":"1","_rn_":"15"},{"1":"CHECK (69):PIRA + METC 1X (23):PIRA + METC 2X (66):TFLX + PROT 2X (41)","2":"0.002511296","3":"18","4":"1","_rn_":"18"},{"1":"CHECK (69):PIRA + METC 2X (66):TEBU 2X (25)","2":"0.002519506","3":"19","4":"1","_rn_":"21"},{"1":"CHECK (69):PIRA + METC 2X (66):TFLX + PROT 2X (41)","2":"0.002466547","3":"19","4":"1","_rn_":"23"},{"1":"CHECK (69):PIRA + METC 2X (66):TFLX + PROT 2X (41):TFLX + TEBU 2X (36)","2":"0.002017296","3":"18","4":"1","_rn_":"25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>



Copyright 2017 Emerson Del Ponte


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
